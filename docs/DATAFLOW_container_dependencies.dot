// Diagram #19: Container Dependencies
// Docker compose startup order and health checks

digraph ContainerDependencies {
    rankdir=TB;
    graph [fontsize=14, fontname="Arial", bgcolor="#f5f5f5", style=filled];
    node [shape=box, style=filled, fontsize=12, fontname="Arial"];
    edge [fontsize=10, fontname="Arial"];

    // Start
    Start [label="docker-compose up", shape=ellipse, fillcolor=lightgreen];

    // Standard entities (databases)
    Postgres [label="PostgreSQL\n5432", fillcolor=skyblue, shape=cylinder];
    Neo4j [label="Neo4j\n7474/7687", fillcolor=skyblue, shape=cylinder];
    Redis [label="Redis\n6379", fillcolor=skyblue, shape=cylinder];
    Qdrant [label="Qdrant\n6333", fillcolor=skyblue, shape=cylinder];

    // Standard entities (services)
    Backend [label="FastAPI Backend\nPort 8000", fillcolor=lightgreen];
    MedicalCatalog [label="Medical Catalog\nPort 8001", fillcolor=lightpink];
    Frontend [label="Next.js Frontend\nPort 3000", fillcolor=lightyellow];

    // Startup flow
    Start -> Postgres [label="Start"];
    Start -> Neo4j [label="Start"];
    Start -> Redis [label="Start"];
    Start -> Qdrant [label="Start"];

    Postgres -> Backend [label="Wait for\nhealthy"];
    Neo4j -> Backend [label="Wait for\nhealthy"];
    Redis -> Backend [label="Wait for\nhealthy"];

    Qdrant -> MedicalCatalog [label="Wait for\nhealthy"];

    Backend -> Frontend [label="Wait for\nready"];
    MedicalCatalog -> Backend [label="Optional\ndependency", style=dashed];
}
