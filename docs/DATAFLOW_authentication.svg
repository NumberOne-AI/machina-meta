<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (0)
 -->
<!-- Title: Authentication Pages: 1 -->
<svg width="787pt" height="256pt"
 viewBox="0.00 0.00 786.50 255.82" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 251.82)">
<title>Authentication</title>
<polygon fill="#f5f5f5" stroke="none" points="-4,4 -4,-251.82 782.5,-251.82 782.5,4 -4,4"/>
<!-- Browser -->
<g id="node1" class="node">
<title>Browser</title>
<polygon fill="lightblue" stroke="black" points="88,-120 0,-120 0,-84 88,-84 88,-120"/>
<text text-anchor="middle" x="44" y="-97.72" font-family="Arial" font-size="12.00">Web Browser</text>
</g>
<!-- NextJS -->
<g id="node2" class="node">
<title>NextJS</title>
<polygon fill="lightyellow" stroke="black" points="319.12,-156.25 215.38,-156.25 215.38,-119.75 319.12,-119.75 319.12,-156.25"/>
<text text-anchor="middle" x="267.25" y="-140.85" font-family="Arial" font-size="12.00">Next.js Frontend</text>
<text text-anchor="middle" x="267.25" y="-126.6" font-family="Arial" font-size="12.00">Port 3000</text>
</g>
<!-- Browser&#45;&gt;NextJS -->
<g id="edge1" class="edge">
<title>Browser&#45;&gt;NextJS</title>
<path fill="none" stroke="black" d="M55.85,-120.49C66.38,-136.44 83.99,-158.37 106,-168 142,-183.74 186.07,-173.59 218.88,-161"/>
<polygon fill="black" stroke="black" points="220.2,-164.24 228.14,-157.24 217.56,-157.76 220.2,-164.24"/>
<text text-anchor="middle" x="149.88" y="-178.53" font-family="Arial" font-size="10.00">Visit /login</text>
</g>
<!-- Browser&#45;&gt;NextJS -->
<g id="edge5" class="edge">
<title>Browser&#45;&gt;NextJS</title>
<path fill="none" stroke="black" d="M74.68,-120.36C84.32,-125.41 95.3,-130.25 106,-133 137.56,-141.08 173.76,-142.81 203.76,-142.32"/>
<polygon fill="black" stroke="black" points="203.51,-145.83 213.42,-142.07 203.33,-138.83 203.51,-145.83"/>
<text text-anchor="middle" x="149.88" y="-144.89" font-family="Arial" font-size="10.00">ID Token</text>
</g>
<!-- FastAPI -->
<g id="node3" class="node">
<title>FastAPI</title>
<polygon fill="lightgreen" stroke="black" points="550.25,-121.25 441.25,-121.25 441.25,-84.75 550.25,-84.75 550.25,-121.25"/>
<text text-anchor="middle" x="495.75" y="-105.85" font-family="Arial" font-size="12.00">FastAPI Backend</text>
<text text-anchor="middle" x="495.75" y="-91.6" font-family="Arial" font-size="12.00">Port 8000</text>
</g>
<!-- Browser&#45;&gt;FastAPI -->
<g id="edge13" class="edge">
<title>Browser&#45;&gt;FastAPI</title>
<path fill="none" stroke="blue" d="M51.28,-120.17C59.85,-141.8 77.48,-176.87 106,-192 155.52,-218.25 323.39,-223.27 423.25,-177 445,-166.92 463.59,-147.08 476.35,-130.48"/>
<polygon fill="blue" stroke="blue" points="478.83,-133.02 481.94,-122.89 473.19,-128.87 478.83,-133.02"/>
<text text-anchor="middle" x="267.25" y="-238.32" font-family="Arial" font-size="10.00">GET /api/v1/auth/session</text>
<text text-anchor="middle" x="267.25" y="-226.32" font-family="Arial" font-size="10.00">(every 60s)</text>
<text text-anchor="middle" x="267.25" y="-214.32" font-family="Arial" font-size="10.00">Cookie: JWT</text>
</g>
<!-- GoogleOAuth -->
<g id="node5" class="node">
<title>GoogleOAuth</title>
<polygon fill="plum" stroke="black" points="778.5,-41 686.75,-41 686.75,-5 778.5,-5 778.5,-41"/>
<text text-anchor="middle" x="732.62" y="-18.72" font-family="Arial" font-size="12.00">Google OAuth</text>
</g>
<!-- Browser&#45;&gt;GoogleOAuth -->
<g id="edge3" class="edge">
<title>Browser&#45;&gt;GoogleOAuth</title>
<path fill="none" stroke="black" d="M70.53,-83.57C81.02,-76.92 93.61,-70.05 106,-66 302.23,-1.8 362.04,-30.23 568.25,-20 603.83,-18.23 643.82,-18.92 675.32,-20.08"/>
<polygon fill="black" stroke="black" points="674.88,-23.56 685.01,-20.46 675.16,-16.57 674.88,-23.56"/>
<text text-anchor="middle" x="382" y="-25" font-family="Arial" font-size="10.00">Google SSO</text>
</g>
<!-- NextJS&#45;&gt;Browser -->
<g id="edge2" class="edge">
<title>NextJS&#45;&gt;Browser</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M214.9,-125.26C207.82,-123.71 200.62,-122.24 193.75,-121 162.79,-115.4 127.91,-110.86 99.71,-107.61"/>
<polygon fill="black" stroke="black" points="100.3,-104.16 89.97,-106.52 99.52,-111.12 100.3,-104.16"/>
<text text-anchor="middle" x="149.88" y="-123.5" font-family="Arial" font-size="10.00">Redirect to Google</text>
</g>
<!-- NextJS&#45;&gt;Browser -->
<g id="edge12" class="edge">
<title>NextJS&#45;&gt;Browser</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243.68,-119.39C230.11,-109.44 211.99,-98.19 193.75,-93 163.33,-84.32 128.03,-85.99 99.46,-90.09"/>
<polygon fill="black" stroke="black" points="99.29,-86.58 89.96,-91.6 100.39,-93.49 99.29,-86.58"/>
<text text-anchor="middle" x="149.88" y="-95.5" font-family="Arial" font-size="10.00">Redirect /dashboard</text>
</g>
<!-- NextJS&#45;&gt;FastAPI -->
<g id="edge6" class="edge">
<title>NextJS&#45;&gt;FastAPI</title>
<path fill="none" stroke="black" d="M319.32,-138.18C349.77,-137.42 389.03,-134.95 423.25,-128 427.55,-127.12 431.94,-126.05 436.33,-124.85"/>
<polygon fill="black" stroke="black" points="437.13,-128.26 445.73,-122.06 435.14,-121.55 437.13,-128.26"/>
<text text-anchor="middle" x="382" y="-163.75" font-family="Arial" font-size="10.00">HTTP POST</text>
<text text-anchor="middle" x="382" y="-151.75" font-family="Arial" font-size="10.00">/api/v1/auth/google</text>
<text text-anchor="middle" x="382" y="-139.75" font-family="Arial" font-size="10.00">ID Token</text>
</g>
<!-- FastAPI&#45;&gt;Browser -->
<g id="edge14" class="edge">
<title>FastAPI&#45;&gt;Browser</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M448.42,-84.28C440.16,-81.67 431.55,-79.4 423.25,-78 284.22,-54.39 245.18,-60.3 106,-83 103.82,-83.35 101.62,-83.76 99.4,-84.23"/>
<polygon fill="blue" stroke="blue" points="98.68,-80.8 89.77,-86.53 100.31,-87.61 98.68,-80.8"/>
<text text-anchor="middle" x="267.25" y="-81.57" font-family="Arial" font-size="10.00">HTTP 200</text>
<text text-anchor="middle" x="267.25" y="-69.57" font-family="Arial" font-size="10.00">Session valid</text>
</g>
<!-- FastAPI&#45;&gt;NextJS -->
<g id="edge11" class="edge">
<title>FastAPI&#45;&gt;NextJS</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M440.95,-87.53C410.88,-81.41 373.07,-77.93 340.75,-88 324.93,-92.92 309.51,-102.64 296.99,-112.21"/>
<polygon fill="black" stroke="black" points="294.8,-109.47 289.2,-118.46 299.19,-114.93 294.8,-109.47"/>
<text text-anchor="middle" x="382" y="-114.5" font-family="Arial" font-size="10.00">HTTP 200</text>
<text text-anchor="middle" x="382" y="-102.5" font-family="Arial" font-size="10.00">Set&#45;Cookie: JWT</text>
<text text-anchor="middle" x="382" y="-90.5" font-family="Arial" font-size="10.00">access + refresh</text>
</g>
<!-- Postgres -->
<g id="node4" class="node">
<title>Postgres</title>
<path fill="skyblue" stroke="black" d="M773.25,-146.53C773.25,-149.04 755.04,-151.09 732.62,-151.09 710.21,-151.09 692,-149.04 692,-146.53 692,-146.53 692,-105.46 692,-105.46 692,-102.95 710.21,-100.9 732.62,-100.9 755.04,-100.9 773.25,-102.95 773.25,-105.46 773.25,-105.46 773.25,-146.53 773.25,-146.53"/>
<path fill="none" stroke="black" d="M773.25,-146.53C773.25,-144.01 755.04,-141.96 732.62,-141.96 710.21,-141.96 692,-144.01 692,-146.53"/>
<text text-anchor="middle" x="732.62" y="-128.85" font-family="Arial" font-size="12.00">PostgreSQL</text>
<text text-anchor="middle" x="732.62" y="-114.6" font-family="Arial" font-size="12.00">5432</text>
</g>
<!-- FastAPI&#45;&gt;Postgres -->
<g id="edge9" class="edge">
<title>FastAPI&#45;&gt;Postgres</title>
<path fill="none" stroke="black" d="M550.74,-118.77C556.61,-120.06 562.53,-121.18 568.25,-122 605.52,-127.33 648.05,-128.21 680.37,-127.82"/>
<polygon fill="black" stroke="black" points="680.34,-131.32 690.28,-127.65 680.22,-124.32 680.34,-131.32"/>
<text text-anchor="middle" x="618.5" y="-142.4" font-family="Arial" font-size="10.00">PostgreSQL</text>
<text text-anchor="middle" x="618.5" y="-130.4" font-family="Arial" font-size="10.00">SELECT/INSERT user</text>
</g>
<!-- FastAPI&#45;&gt;GoogleOAuth -->
<g id="edge7" class="edge">
<title>FastAPI&#45;&gt;GoogleOAuth</title>
<path fill="none" stroke="black" d="M550.4,-88C592.33,-76.11 647.04,-60.17 668.75,-52 673.69,-50.13 678.79,-48.06 683.85,-45.89"/>
<polygon fill="black" stroke="black" points="684.97,-49.22 692.71,-41.98 682.15,-42.82 684.97,-49.22"/>
<text text-anchor="middle" x="618.5" y="-85.26" font-family="Arial" font-size="10.00">Verify token</text>
</g>
<!-- Postgres&#45;&gt;FastAPI -->
<g id="edge10" class="edge">
<title>Postgres&#45;&gt;FastAPI</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M691.75,-112.19C684.2,-110.08 676.29,-108.2 668.75,-107 633.66,-101.39 594.03,-100.13 561.67,-100.39"/>
<polygon fill="black" stroke="black" points="562.01,-96.88 552.06,-100.52 562.11,-103.88 562.01,-96.88"/>
<text text-anchor="middle" x="618.5" y="-109.5" font-family="Arial" font-size="10.00">User record</text>
</g>
<!-- GoogleOAuth&#45;&gt;Browser -->
<g id="edge4" class="edge">
<title>GoogleOAuth&#45;&gt;Browser</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M686.34,-16.74C680.43,-16.07 674.45,-15.46 668.75,-15 466.31,1.56 412.91,9.17 211.75,-19 164.46,-25.62 148.05,-15.37 106,-38 89.53,-46.86 74.91,-61.79 64.12,-75"/>
<polygon fill="black" stroke="black" points="61.6,-72.54 58.22,-82.58 67.12,-76.84 61.6,-72.54"/>
<text text-anchor="middle" x="382" y="-6.52" font-family="Arial" font-size="10.00">ID Token</text>
</g>
<!-- GoogleOAuth&#45;&gt;FastAPI -->
<g id="edge8" class="edge">
<title>GoogleOAuth&#45;&gt;FastAPI</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M686.36,-19.18C652.43,-18.11 605.63,-20.51 568.25,-37 548.79,-45.58 531.19,-61.68 518.31,-75.83"/>
<polygon fill="black" stroke="black" points="515.85,-73.32 511.93,-83.16 521.13,-77.92 515.85,-73.32"/>
<text text-anchor="middle" x="618.5" y="-39.5" font-family="Arial" font-size="10.00">Token valid</text>
</g>
</g>
</svg>
