<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (0)
 -->
<!-- Title: DocumentUpload Pages: 1 -->
<svg width="787pt" height="306pt"
 viewBox="0.00 0.00 786.75 306.23" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 302.23)">
<title>DocumentUpload</title>
<polygon fill="#f5f5f5" stroke="none" points="-4,4 -4,-302.23 782.75,-302.23 782.75,4 -4,4"/>
<!-- Browser -->
<g id="node1" class="node">
<title>Browser</title>
<polygon fill="lightblue" stroke="black" points="88,-173.75 0,-173.75 0,-137.75 88,-137.75 88,-173.75"/>
<text text-anchor="middle" x="44" y="-151.48" font-family="Arial" font-size="12.00">Web Browser</text>
</g>
<!-- NextJS -->
<g id="node2" class="node">
<title>NextJS</title>
<polygon fill="lightyellow" stroke="black" points="299,-174 195.25,-174 195.25,-137.5 299,-137.5 299,-174"/>
<text text-anchor="middle" x="247.12" y="-158.6" font-family="Arial" font-size="12.00">Next.js Frontend</text>
<text text-anchor="middle" x="247.12" y="-144.35" font-family="Arial" font-size="12.00">Port 3000</text>
</g>
<!-- Browser&#45;&gt;NextJS -->
<g id="edge1" class="edge">
<title>Browser&#45;&gt;NextJS</title>
<path fill="none" stroke="black" d="M88.15,-155.75C116.01,-155.75 152.7,-155.75 183.72,-155.75"/>
<polygon fill="black" stroke="black" points="183.35,-159.25 193.35,-155.75 183.35,-152.25 183.35,-159.25"/>
<text text-anchor="middle" x="141.62" y="-158.25" font-family="Arial" font-size="10.00">User selects file</text>
</g>
<!-- NextJS&#45;&gt;Browser -->
<g id="edge10" class="edge">
<title>NextJS&#45;&gt;Browser</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M194.82,-142.49C188.93,-141.36 182.98,-140.41 177.25,-139.75 145.79,-136.15 137.41,-135.7 106,-139.75 103.84,-140.03 101.65,-140.36 99.45,-140.74"/>
<polygon fill="black" stroke="black" points="99,-137.26 89.87,-142.63 100.36,-144.12 99,-137.26"/>
<text text-anchor="middle" x="141.62" y="-142.25" font-family="Arial" font-size="10.00">Show file info</text>
</g>
<!-- FileStorageAPI -->
<g id="node3" class="node">
<title>FileStorageAPI</title>
<polygon fill="wheat" stroke="black" points="520.5,-173.75 416.75,-173.75 416.75,-137.75 520.5,-137.75 520.5,-173.75"/>
<text text-anchor="middle" x="468.62" y="-151.48" font-family="Arial" font-size="12.00">File Storage API</text>
</g>
<!-- NextJS&#45;&gt;FileStorageAPI -->
<g id="edge2" class="edge">
<title>NextJS&#45;&gt;FileStorageAPI</title>
<path fill="none" stroke="black" d="M299.27,-157.4C305.25,-157.55 311.26,-157.67 317,-157.75 353.33,-158.28 362.42,-158.28 398.75,-157.75 400.81,-157.72 402.91,-157.69 405.03,-157.65"/>
<polygon fill="black" stroke="black" points="405.04,-161.15 414.96,-157.43 404.89,-154.15 405.04,-161.15"/>
<text text-anchor="middle" x="357.88" y="-184.65" font-family="Arial" font-size="10.00">HTTP POST</text>
<text text-anchor="middle" x="357.88" y="-172.65" font-family="Arial" font-size="10.00">/files/upload</text>
<text text-anchor="middle" x="357.88" y="-160.65" font-family="Arial" font-size="10.00">Multipart form data</text>
</g>
<!-- FileStorageAPI&#45;&gt;NextJS -->
<g id="edge9" class="edge">
<title>FileStorageAPI&#45;&gt;NextJS</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M426.06,-137.32C417.21,-134.18 407.8,-131.4 398.75,-129.75 363.01,-123.23 352.74,-123.23 317,-129.75 311.77,-130.7 306.43,-132.03 301.14,-133.59"/>
<polygon fill="black" stroke="black" points="300.3,-130.18 291.87,-136.6 302.46,-136.84 300.3,-130.18"/>
<text text-anchor="middle" x="357.88" y="-144.25" font-family="Arial" font-size="10.00">HTTP 200</text>
<text text-anchor="middle" x="357.88" y="-132.25" font-family="Arial" font-size="10.00">FileRecordOut</text>
</g>
<!-- GCS -->
<g id="node4" class="node">
<title>GCS</title>
<path fill="lavender" stroke="black" d="M778.75,-264.48C778.75,-266.28 748.44,-267.75 711.12,-267.75 673.81,-267.75 643.5,-266.28 643.5,-264.48 643.5,-264.48 643.5,-235.02 643.5,-235.02 643.5,-233.22 673.81,-231.75 711.12,-231.75 748.44,-231.75 778.75,-233.22 778.75,-235.02 778.75,-235.02 778.75,-264.48 778.75,-264.48"/>
<path fill="none" stroke="black" d="M778.75,-264.48C778.75,-262.67 748.44,-261.21 711.12,-261.21 673.81,-261.21 643.5,-262.67 643.5,-264.48"/>
<text text-anchor="middle" x="711.12" y="-245.48" font-family="Arial" font-size="12.00">Google Cloud Storage</text>
</g>
<!-- FileStorageAPI&#45;&gt;GCS -->
<g id="edge3" class="edge">
<title>FileStorageAPI&#45;&gt;GCS</title>
<path fill="none" stroke="green" d="M477.44,-173.88C487.85,-195.47 508.51,-230.5 538.5,-245.75 566.89,-260.19 601.49,-263.27 632.17,-261.96"/>
<polygon fill="green" stroke="green" points="631.99,-265.48 641.76,-261.38 631.57,-258.49 631.99,-265.48"/>
<text text-anchor="middle" x="582" y="-288.73" font-family="Arial" font-size="10.00">GCS Client API</text>
<text text-anchor="middle" x="582" y="-276.73" font-family="Arial" font-size="10.00">Upload binary</text>
<text text-anchor="middle" x="582" y="-264.73" font-family="Arial" font-size="10.00">(if storage=GCS)</text>
</g>
<!-- LocalFS -->
<g id="node5" class="node">
<title>LocalFS</title>
<path fill="lightgray" stroke="black" d="M764.12,-171.48C764.12,-173.28 740.37,-174.75 711.12,-174.75 681.88,-174.75 658.12,-173.28 658.12,-171.48 658.12,-171.48 658.12,-142.02 658.12,-142.02 658.12,-140.22 681.88,-138.75 711.12,-138.75 740.37,-138.75 764.12,-140.22 764.12,-142.02 764.12,-142.02 764.12,-171.48 764.12,-171.48"/>
<path fill="none" stroke="black" d="M764.12,-171.48C764.12,-169.67 740.37,-168.21 711.12,-168.21 681.88,-168.21 658.12,-169.67 658.12,-171.48"/>
<text text-anchor="middle" x="711.12" y="-152.48" font-family="Arial" font-size="12.00">Local Filesystem</text>
</g>
<!-- FileStorageAPI&#45;&gt;LocalFS -->
<g id="edge4" class="edge">
<title>FileStorageAPI&#45;&gt;LocalFS</title>
<path fill="none" stroke="orange" d="M520.92,-155.96C557.59,-156.12 607.17,-156.32 646.37,-156.49"/>
<polygon fill="orange" stroke="orange" points="646.13,-159.99 656.15,-156.53 646.16,-152.99 646.13,-159.99"/>
<text text-anchor="middle" x="582" y="-182.9" font-family="Arial" font-size="10.00">File I/O</text>
<text text-anchor="middle" x="582" y="-170.9" font-family="Arial" font-size="10.00">Write to disk</text>
<text text-anchor="middle" x="582" y="-158.9" font-family="Arial" font-size="10.00">(if storage=LOCAL)</text>
</g>
<!-- Postgres -->
<g id="node6" class="node">
<title>Postgres</title>
<path fill="skyblue" stroke="black" d="M751.75,-47.28C751.75,-49.8 733.54,-51.85 711.12,-51.85 688.71,-51.85 670.5,-49.8 670.5,-47.28 670.5,-47.28 670.5,-6.22 670.5,-6.22 670.5,-3.7 688.71,-1.66 711.12,-1.66 733.54,-1.66 751.75,-3.7 751.75,-6.22 751.75,-6.22 751.75,-47.28 751.75,-47.28"/>
<path fill="none" stroke="black" d="M751.75,-47.28C751.75,-44.77 733.54,-42.72 711.12,-42.72 688.71,-42.72 670.5,-44.77 670.5,-47.28"/>
<text text-anchor="middle" x="711.12" y="-29.6" font-family="Arial" font-size="12.00">PostgreSQL</text>
<text text-anchor="middle" x="711.12" y="-15.35" font-family="Arial" font-size="12.00">5432</text>
</g>
<!-- FileStorageAPI&#45;&gt;Postgres -->
<g id="edge7" class="edge">
<title>FileStorageAPI&#45;&gt;Postgres</title>
<path fill="none" stroke="black" d="M477.66,-137.5C488.29,-115.61 509.16,-79.54 538.5,-60.75 574.51,-37.69 622.81,-29.71 659,-27.2"/>
<polygon fill="black" stroke="black" points="658.99,-30.71 668.78,-26.65 658.6,-23.72 658.99,-30.71"/>
<text text-anchor="middle" x="582" y="-123.25" font-family="Arial" font-size="10.00">PostgreSQL</text>
<text text-anchor="middle" x="582" y="-111.25" font-family="Arial" font-size="10.00">INSERT FileRecord</text>
<text text-anchor="middle" x="582" y="-99.25" font-family="Arial" font-size="10.00">(file_id, filename,</text>
<text text-anchor="middle" x="582" y="-87.25" font-family="Arial" font-size="10.00">mimetype, size,</text>
<text text-anchor="middle" x="582" y="-75.25" font-family="Arial" font-size="10.00">storage_path,</text>
<text text-anchor="middle" x="582" y="-63.25" font-family="Arial" font-size="10.00">user_id)</text>
</g>
<!-- GCS&#45;&gt;FileStorageAPI -->
<g id="edge5" class="edge">
<title>GCS&#45;&gt;FileStorageAPI</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M643.18,-233.07C610.89,-224.02 571.98,-211.63 538.5,-196.75 527.82,-192 516.73,-185.96 506.65,-179.98"/>
<polygon fill="green" stroke="green" points="508.62,-177.07 498.26,-174.85 504.97,-183.05 508.62,-177.07"/>
<text text-anchor="middle" x="582" y="-229.26" font-family="Arial" font-size="10.00">gs://path</text>
</g>
<!-- LocalFS&#45;&gt;FileStorageAPI -->
<g id="edge6" class="edge">
<title>LocalFS&#45;&gt;FileStorageAPI</title>
<path fill="none" stroke="orange" stroke-dasharray="5,2" d="M658,-144.6C647.31,-142.58 636.09,-140.8 625.5,-139.75 587.02,-135.92 576.92,-135.35 538.5,-139.75 536.44,-139.99 534.35,-140.26 532.25,-140.57"/>
<polygon fill="orange" stroke="orange" points="531.69,-137.11 522.42,-142.23 532.86,-144.02 531.69,-137.11"/>
<text text-anchor="middle" x="582" y="-142.25" font-family="Arial" font-size="10.00">/path/to/file</text>
</g>
<!-- Postgres&#45;&gt;FileStorageAPI -->
<g id="edge8" class="edge">
<title>Postgres&#45;&gt;FileStorageAPI</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M670.12,-11.76C633.12,-0.61 578.04,8.86 538.5,-15.75 499.62,-39.95 482.06,-93.25 474.61,-126.66"/>
<polygon fill="black" stroke="black" points="471.26,-125.58 472.68,-136.08 478.11,-126.98 471.26,-125.58"/>
<text text-anchor="middle" x="582" y="-18.25" font-family="Arial" font-size="10.00">file_id</text>
</g>
</g>
</svg>
