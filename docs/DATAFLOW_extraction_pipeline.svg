<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (0)
 -->
<!-- Title: ExtractionPipeline Pages: 1 -->
<svg width="695pt" height="813pt"
 viewBox="0.00 0.00 694.62 812.75" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 808.75)">
<title>ExtractionPipeline</title>
<polygon fill="#f5f5f5" stroke="none" points="-4,4 -4,-808.75 690.62,-808.75 690.62,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stages</title>
<polygon fill="lightyellow" stroke="black" points="211.38,-172.5 211.38,-718.75 357.38,-718.75 357.38,-172.5 211.38,-172.5"/>
<text text-anchor="middle" x="284.38" y="-701.45" font-family="Arial" font-size="14.00">Pipeline Stages</text>
</g>
<!-- DocProcAPI -->
<g id="node1" class="node">
<title>DocProcAPI</title>
<polygon fill="wheat" stroke="black" points="514.88,-132.5 429.88,-132.5 429.88,-96.5 514.88,-96.5 514.88,-132.5"/>
<text text-anchor="middle" x="472.38" y="-110.22" font-family="Arial" font-size="12.00">DocProc API</text>
</g>
<!-- ExtractionPipeline -->
<g id="node2" class="node">
<title>ExtractionPipeline</title>
<polygon fill="wheat" stroke="black" points="686.62,-36.25 570.12,-36.25 570.12,-0.25 686.62,-0.25 686.62,-36.25"/>
<text text-anchor="middle" x="628.38" y="-13.97" font-family="Arial" font-size="12.00">Extraction Pipeline</text>
</g>
<!-- DocProcAPI&#45;&gt;ExtractionPipeline -->
<g id="edge1" class="edge">
<title>DocProcAPI&#45;&gt;ExtractionPipeline</title>
<path fill="none" stroke="black" d="M515.09,-98.39C527.63,-93.02 541.02,-86.34 552.38,-78.5 564.66,-70.02 564.4,-64.04 575.88,-54.5 580.57,-50.6 585.7,-46.72 590.86,-43.05"/>
<polygon fill="black" stroke="black" points="592.59,-46.12 598.84,-37.56 588.62,-40.35 592.59,-46.12"/>
<text text-anchor="middle" x="612.62" y="-69" font-family="Arial" font-size="10.00">Background task</text>
<text text-anchor="middle" x="612.62" y="-57" font-family="Arial" font-size="10.00">file_id</text>
</g>
<!-- NextJS -->
<g id="node6" class="node">
<title>NextJS</title>
<polygon fill="lightyellow" stroke="black" points="517.25,-36.5 413.5,-36.5 413.5,0 517.25,0 517.25,-36.5"/>
<text text-anchor="middle" x="465.38" y="-21.1" font-family="Arial" font-size="12.00">Next.js Frontend</text>
<text text-anchor="middle" x="465.38" y="-6.85" font-family="Arial" font-size="12.00">Port 3000</text>
</g>
<!-- DocProcAPI&#45;&gt;NextJS -->
<g id="edge19" class="edge">
<title>DocProcAPI&#45;&gt;NextJS</title>
<path fill="none" stroke="blue" d="M469.18,-96.11C468.28,-90.51 467.4,-84.26 466.88,-78.5 465.98,-68.7 465.55,-57.96 465.36,-48.34"/>
<polygon fill="blue" stroke="blue" points="468.86,-48.39 465.24,-38.43 461.86,-48.47 468.86,-48.39"/>
<text text-anchor="middle" x="509.62" y="-69" font-family="Arial" font-size="10.00">Server&#45;Sent Events</text>
<text text-anchor="middle" x="509.62" y="-57" font-family="Arial" font-size="10.00">Streaming progress</text>
</g>
<!-- LoadFile -->
<g id="node7" class="node">
<title>LoadFile</title>
<polygon fill="wheat" stroke="black" points="341.88,-687 262.88,-687 262.88,-651 341.88,-651 341.88,-687"/>
<text text-anchor="middle" x="302.38" y="-664.73" font-family="Arial" font-size="12.00">1. Load File</text>
</g>
<!-- ExtractionPipeline&#45;&gt;LoadFile -->
<g id="edge2" class="edge">
<title>ExtractionPipeline&#45;&gt;LoadFile</title>
<path fill="none" stroke="black" d="M640.16,-36.64C643.51,-42.17 646.91,-48.43 649.38,-54.5 659.5,-79.48 663.38,-86.55 663.38,-113.5 663.38,-585.75 663.38,-585.75 663.38,-585.75 663.38,-648.59 452.82,-663.42 353.32,-666.92"/>
<polygon fill="black" stroke="black" points="353.44,-663.41 343.55,-667.23 353.66,-670.41 353.44,-663.41"/>
</g>
<!-- GCS -->
<g id="node3" class="node">
<title>GCS</title>
<path fill="lavender" stroke="black" d="M369,-801.48C369,-803.28 338.69,-804.75 301.38,-804.75 264.06,-804.75 233.75,-803.28 233.75,-801.48 233.75,-801.48 233.75,-772.02 233.75,-772.02 233.75,-770.22 264.06,-768.75 301.38,-768.75 338.69,-768.75 369,-770.22 369,-772.02 369,-772.02 369,-801.48 369,-801.48"/>
<path fill="none" stroke="black" d="M369,-801.48C369,-799.67 338.69,-798.2 301.38,-798.2 264.06,-798.2 233.75,-799.67 233.75,-801.48"/>
<text text-anchor="middle" x="301.38" y="-782.48" font-family="Arial" font-size="12.00">Google Cloud Storage</text>
</g>
<!-- GCS&#45;&gt;LoadFile -->
<g id="edge4" class="edge">
<title>GCS&#45;&gt;LoadFile</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M276.35,-768.61C270.9,-763.55 265.87,-757.52 262.88,-750.75 258.56,-741 259.68,-736.93 262.88,-726.75 266.29,-715.87 272.61,-705.25 279.21,-696.19"/>
<polygon fill="black" stroke="black" points="281.76,-698.61 285.14,-688.57 276.24,-694.31 281.76,-698.61"/>
<text text-anchor="middle" x="287.62" y="-735.25" font-family="Arial" font-size="10.00">Binary data</text>
</g>
<!-- GeminiAPI -->
<g id="node4" class="node">
<title>GeminiAPI</title>
<polygon fill="plum" stroke="black" points="118.75,-385.75 0,-385.75 0,-349.75 118.75,-349.75 118.75,-385.75"/>
<text text-anchor="middle" x="59.38" y="-363.48" font-family="Arial" font-size="12.00">Google Gemini API</text>
</g>
<!-- ExtractMetadata -->
<g id="node9" class="node">
<title>ExtractMetadata</title>
<polygon fill="wheat" stroke="black" points="337.38,-506.5 219.38,-506.5 219.38,-470 337.38,-470 337.38,-506.5"/>
<text text-anchor="middle" x="278.38" y="-491.1" font-family="Arial" font-size="12.00">3. Extract Metadata</text>
<text text-anchor="middle" x="278.38" y="-476.85" font-family="Arial" font-size="12.00">MetadataAgent</text>
</g>
<!-- GeminiAPI&#45;&gt;ExtractMetadata -->
<g id="edge8" class="edge">
<title>GeminiAPI&#45;&gt;ExtractMetadata</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M119.01,-378.84C141.13,-384.21 165.83,-392.22 186.38,-404 212.96,-419.24 213.06,-431.54 235.88,-452 239.67,-455.4 243.72,-458.92 247.76,-462.34"/>
<polygon fill="black" stroke="black" points="245.4,-464.93 255.32,-468.67 249.89,-459.56 245.4,-464.93"/>
<text text-anchor="middle" x="256.12" y="-424.5" font-family="Arial" font-size="10.00">Metadata</text>
</g>
<!-- ExtractBiomarkers -->
<g id="node10" class="node">
<title>ExtractBiomarkers</title>
<polygon fill="wheat" stroke="black" points="349,-386 219.75,-386 219.75,-349.5 349,-349.5 349,-386"/>
<text text-anchor="middle" x="284.38" y="-370.6" font-family="Arial" font-size="12.00">4. Extract Biomarkers</text>
<text text-anchor="middle" x="284.38" y="-356.35" font-family="Arial" font-size="12.00">GenericAgent</text>
</g>
<!-- GeminiAPI&#45;&gt;ExtractBiomarkers -->
<g id="edge11" class="edge">
<title>GeminiAPI&#45;&gt;ExtractBiomarkers</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M119.08,-367.75C146.43,-367.75 179.17,-367.75 208.27,-367.75"/>
<polygon fill="black" stroke="black" points="208.13,-371.25 218.13,-367.75 208.13,-364.25 208.13,-371.25"/>
<text text-anchor="middle" x="169.25" y="-373.25" font-family="Arial" font-size="10.00">List[Biomarker]</text>
</g>
<!-- MedicalDataEngine -->
<g id="node5" class="node">
<title>MedicalDataEngine</title>
<polygon fill="palegreen" stroke="black" points="635.25,-216.75 507.5,-216.75 507.5,-180.75 635.25,-180.75 635.25,-216.75"/>
<text text-anchor="middle" x="571.38" y="-194.47" font-family="Arial" font-size="12.00">Medical Data Engine</text>
</g>
<!-- MedicalDataEngine&#45;&gt;DocProcAPI -->
<g id="edge18" class="edge">
<title>MedicalDataEngine&#45;&gt;DocProcAPI</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M550.38,-180.31C536.34,-168.64 517.65,-153.11 502.08,-140.18"/>
<polygon fill="blue" stroke="blue" points="504.43,-137.58 494.5,-133.89 499.96,-142.97 504.43,-137.58"/>
<text text-anchor="middle" x="576.93" y="-153" font-family="Arial" font-size="10.00">SSE: phase=complete</text>
</g>
<!-- LoadFile&#45;&gt;GCS -->
<g id="edge3" class="edge">
<title>LoadFile&#45;&gt;GCS</title>
<path fill="none" stroke="black" d="M309.16,-687.39C314.66,-703.78 320.84,-729.01 316.38,-750.75 315.9,-753.08 315.26,-755.44 314.51,-757.78"/>
<polygon fill="black" stroke="black" points="311.3,-756.39 310.99,-766.98 317.83,-758.9 311.3,-756.39"/>
<text text-anchor="middle" x="338.15" y="-741.25" font-family="Arial" font-size="10.00">GCS API</text>
<text text-anchor="middle" x="338.15" y="-729.25" font-family="Arial" font-size="10.00">Fetch file</text>
</g>
<!-- ConvertImages -->
<g id="node8" class="node">
<title>ConvertImages</title>
<polygon fill="wheat" stroke="black" points="326.62,-603 228.12,-603 228.12,-566.5 326.62,-566.5 326.62,-603"/>
<text text-anchor="middle" x="277.38" y="-587.6" font-family="Arial" font-size="12.00">2. Convert PDF</text>
<text text-anchor="middle" x="277.38" y="-573.35" font-family="Arial" font-size="12.00">to Images</text>
</g>
<!-- LoadFile&#45;&gt;ConvertImages -->
<g id="edge5" class="edge">
<title>LoadFile&#45;&gt;ConvertImages</title>
<path fill="none" stroke="black" d="M297.07,-650.56C293.88,-640.05 289.74,-626.42 286.07,-614.37"/>
<polygon fill="black" stroke="black" points="289.45,-613.45 283.2,-604.9 282.76,-615.49 289.45,-613.45"/>
<text text-anchor="middle" x="322.12" y="-623.5" font-family="Arial" font-size="10.00">PDF or Image</text>
</g>
<!-- ConvertImages&#45;&gt;ExtractMetadata -->
<g id="edge6" class="edge">
<title>ConvertImages&#45;&gt;ExtractMetadata</title>
<path fill="none" stroke="black" d="M277.56,-566.42C277.7,-552.91 277.9,-533.88 278.07,-518.09"/>
<polygon fill="black" stroke="black" points="281.57,-518.34 278.17,-508.31 274.57,-518.27 281.57,-518.34"/>
<text text-anchor="middle" x="318.87" y="-539" font-family="Arial" font-size="10.00">Page images</text>
<text text-anchor="middle" x="318.87" y="-527" font-family="Arial" font-size="10.00">(max 3 concurrent)</text>
</g>
<!-- ExtractMetadata&#45;&gt;DocProcAPI -->
<g id="edge15" class="edge">
<title>ExtractMetadata&#45;&gt;DocProcAPI</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M337.87,-478.02C397.14,-465.04 479.38,-435.08 479.38,-368.75 479.38,-368.75 479.38,-368.75 479.38,-197.75 479.38,-179.82 477.7,-159.77 475.99,-143.96"/>
<polygon fill="blue" stroke="blue" points="479.5,-143.83 474.88,-134.3 472.55,-144.63 479.5,-143.83"/>
<text text-anchor="middle" x="522.12" y="-279.75" font-family="Arial" font-size="10.00">SSE: phase=detect</text>
</g>
<!-- ExtractMetadata&#45;&gt;GeminiAPI -->
<g id="edge7" class="edge">
<title>ExtractMetadata&#45;&gt;GeminiAPI</title>
<path fill="none" stroke="black" d="M218.91,-483.2C169.38,-478.63 103.9,-469.45 84.38,-452 69.13,-438.37 63.02,-415.84 60.64,-397.65"/>
<polygon fill="black" stroke="black" points="64.13,-397.32 59.69,-387.7 57.16,-397.99 64.13,-397.32"/>
<text text-anchor="middle" x="135.38" y="-442.5" font-family="Arial" font-size="10.00">HTTPS</text>
<text text-anchor="middle" x="135.38" y="-430.5" font-family="Arial" font-size="10.00">Vision API</text>
<text text-anchor="middle" x="135.38" y="-418.5" font-family="Arial" font-size="10.00">Extract patient_name,</text>
<text text-anchor="middle" x="135.38" y="-406.5" font-family="Arial" font-size="10.00">document_name, dates</text>
</g>
<!-- ExtractMetadata&#45;&gt;ExtractBiomarkers -->
<g id="edge9" class="edge">
<title>ExtractMetadata&#45;&gt;ExtractBiomarkers</title>
<path fill="none" stroke="black" d="M279.27,-469.51C280.24,-450.46 281.78,-419.92 282.92,-397.45"/>
<polygon fill="black" stroke="black" points="286.4,-397.9 283.41,-387.74 279.41,-397.55 286.4,-397.9"/>
<text text-anchor="middle" x="316.56" y="-430.5" font-family="Arial" font-size="10.00">Metadata +</text>
<text text-anchor="middle" x="316.56" y="-418.5" font-family="Arial" font-size="10.00">all page images</text>
</g>
<!-- ExtractBiomarkers&#45;&gt;DocProcAPI -->
<g id="edge16" class="edge">
<title>ExtractBiomarkers&#45;&gt;DocProcAPI</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M337.29,-349C345,-344.38 352.1,-338.62 357.38,-331.5 383.21,-296.62 354.46,-274.53 372.38,-235 389.28,-197.69 421.17,-162.72 444.4,-140.36"/>
<polygon fill="blue" stroke="blue" points="446.54,-143.15 451.43,-133.75 441.74,-138.06 446.54,-143.15"/>
<text text-anchor="middle" x="418.88" y="-237.5" font-family="Arial" font-size="10.00">SSE: phase=process</text>
</g>
<!-- ExtractBiomarkers&#45;&gt;GeminiAPI -->
<g id="edge10" class="edge">
<title>ExtractBiomarkers&#45;&gt;GeminiAPI</title>
<path fill="none" stroke="black" d="M219.65,-367.75C191.67,-367.75 158.86,-367.75 130.24,-367.75"/>
<polygon fill="black" stroke="black" points="130.59,-364.25 120.59,-367.75 130.59,-371.25 130.59,-364.25"/>
<text text-anchor="middle" x="169.25" y="-409.25" font-family="Arial" font-size="10.00">HTTPS</text>
<text text-anchor="middle" x="169.25" y="-397.25" font-family="Arial" font-size="10.00">Vision API</text>
<text text-anchor="middle" x="169.25" y="-385.25" font-family="Arial" font-size="10.00">Extract biomarkers</text>
<text text-anchor="middle" x="169.25" y="-373.25" font-family="Arial" font-size="10.00">(single LLM call)</text>
</g>
<!-- Normalize -->
<g id="node11" class="node">
<title>Normalize</title>
<polygon fill="wheat" stroke="black" points="343.75,-301.5 219,-301.5 219,-265 343.75,-265 343.75,-301.5"/>
<text text-anchor="middle" x="281.38" y="-286.1" font-family="Arial" font-size="12.00">5. Normalize Names</text>
<text text-anchor="middle" x="281.38" y="-271.85" font-family="Arial" font-size="12.00">NormalizerAgent</text>
</g>
<!-- ExtractBiomarkers&#45;&gt;Normalize -->
<g id="edge12" class="edge">
<title>ExtractBiomarkers&#45;&gt;Normalize</title>
<path fill="none" stroke="black" d="M283.74,-349.25C283.36,-338.75 282.86,-325.14 282.42,-313.08"/>
<polygon fill="black" stroke="black" points="285.93,-313.1 282.07,-303.23 278.93,-313.35 285.93,-313.1"/>
<text text-anchor="middle" x="318.68" y="-322" font-family="Arial" font-size="10.00">Raw biomarkers</text>
</g>
<!-- Deduplicate -->
<g id="node12" class="node">
<title>Deduplicate</title>
<polygon fill="wheat" stroke="black" points="340.12,-217 220.62,-217 220.62,-180.5 340.12,-180.5 340.12,-217"/>
<text text-anchor="middle" x="280.38" y="-201.6" font-family="Arial" font-size="12.00">6. Deduplicate</text>
<text text-anchor="middle" x="280.38" y="-187.35" font-family="Arial" font-size="12.00">by catalog_id + unit</text>
</g>
<!-- Normalize&#45;&gt;Deduplicate -->
<g id="edge13" class="edge">
<title>Normalize&#45;&gt;Deduplicate</title>
<path fill="none" stroke="black" d="M281.16,-264.75C281.04,-254.25 280.87,-240.64 280.72,-228.58"/>
<polygon fill="black" stroke="black" points="284.23,-228.69 280.61,-218.73 277.23,-228.78 284.23,-228.69"/>
<text text-anchor="middle" x="309.81" y="-237.5" font-family="Arial" font-size="10.00">Clean names</text>
</g>
<!-- Deduplicate&#45;&gt;DocProcAPI -->
<g id="edge17" class="edge">
<title>Deduplicate&#45;&gt;DocProcAPI</title>
<path fill="none" stroke="blue" stroke-dasharray="1,5" d="M270.19,-180.28C265.96,-170.52 263.46,-158.71 270.38,-150.5 288.95,-128.43 365,-120.28 418.28,-117.26"/>
<polygon fill="blue" stroke="blue" points="418.3,-120.77 428.1,-116.76 417.94,-113.78 418.3,-120.77"/>
<text text-anchor="middle" x="313.88" y="-153" font-family="Arial" font-size="10.00">SSE: phase=upload</text>
</g>
<!-- Deduplicate&#45;&gt;MedicalDataEngine -->
<g id="edge14" class="edge">
<title>Deduplicate&#45;&gt;MedicalDataEngine</title>
<path fill="none" stroke="black" d="M340.32,-198.75C385.37,-198.75 447.4,-198.75 495.85,-198.75"/>
<polygon fill="black" stroke="black" points="495.71,-202.25 505.71,-198.75 495.71,-195.25 495.71,-202.25"/>
<text text-anchor="middle" x="423.81" y="-204.25" font-family="Arial" font-size="10.00">DocumentResourcesNew</text>
</g>
</g>
</svg>
