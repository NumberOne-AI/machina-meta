<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (0)
 -->
<!-- Title: DocumentProcessing Pages: 1 -->
<svg width="1953pt" height="1461pt"
 viewBox="0.00 0.00 1953.10 1460.78" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1456.78)">
<title>DocumentProcessing</title>
<polygon fill="#f5f5f5" stroke="none" points="-4,4 -4,-1456.78 1949.1,-1456.78 1949.1,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_file_storage</title>
<polygon fill="lightgreen" stroke="black" points="26,-838.66 26,-1338.28 302,-1338.28 302,-838.66 26,-838.66"/>
<text text-anchor="middle" x="164" y="-1320.98" font-family="Arial" font-size="14.00">File Storage Service (Port 8000)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_docproc</title>
<polygon fill="lightyellow" stroke="black" points="120,-8 120,-331.25 422,-331.25 422,-8 120,-8"/>
<text text-anchor="middle" x="271" y="-313.95" font-family="Arial" font-size="14.00">Document Processing Service (Port 8000)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_pipeline</title>
<polygon fill="lightcyan" stroke="black" points="474,-8.25 474,-1063.53 642,-1063.53 642,-8.25 474,-8.25"/>
<text text-anchor="middle" x="558" y="-1046.23" font-family="Arial" font-size="14.00">Extraction Pipeline</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_engine</title>
<polygon fill="lightpink" stroke="black" points="1071,-255.25 1071,-1063.28 1299,-1063.28 1299,-255.25 1071,-255.25"/>
<text text-anchor="middle" x="1185" y="-1045.98" font-family="Arial" font-size="14.00">Medical Data Engine</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_catalog</title>
<polygon fill="lavender" stroke="black" points="830,-550.98 830,-914.41 1063,-914.41 1063,-550.98 830,-550.98"/>
<text text-anchor="middle" x="946.5" y="-897.11" font-family="Arial" font-size="14.00">Medical Catalog Service (Port 8001)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_neo4j</title>
<polygon fill="lightgray" stroke="black" points="1307,-375 1307,-957.28 1717,-957.28 1717,-375 1307,-375"/>
<text text-anchor="middle" x="1512" y="-939.98" font-family="Arial" font-size="14.00">Neo4j Graph Database</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_timing</title>
<polygon fill="white" stroke="black" points="696,-1155.53 696,-1444.78 882,-1444.78 882,-1155.53 696,-1155.53"/>
<text text-anchor="middle" x="789" y="-1427.48" font-family="Arial" font-size="14.00">Performance Metrics</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_data_model</title>
<polygon fill="white" stroke="black" points="1083,-1182.03 1083,-1418.28 1293,-1418.28 1293,-1182.03 1083,-1182.03"/>
<text text-anchor="middle" x="1188" y="-1400.98" font-family="Arial" font-size="14.00">Biomarker Data Model</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_pattern</title>
<polygon fill="white" stroke="black" points="1397,-1169.03 1397,-1431.28 1589,-1431.28 1589,-1169.03 1397,-1169.03"/>
<text text-anchor="middle" x="1493" y="-1413.98" font-family="Arial" font-size="14.00">Instanceâ†’Type Pattern</text>
</g>
<!-- user -->
<g id="node1" class="node">
<title>user</title>
<polygon fill="lightblue" stroke="black" points="338,-650.89 284,-650.89 284,-614.89 338,-614.89 338,-650.89"/>
<text text-anchor="middle" x="311" y="-628.62" font-family="Arial" font-size="12.00">User</text>
</g>
<!-- frontend -->
<g id="node2" class="node">
<title>frontend</title>
<polygon fill="lightyellow" stroke="black" points="273.62,-440.75 162.38,-440.75 162.38,-404.25 273.62,-404.25 273.62,-440.75"/>
<text text-anchor="middle" x="218" y="-425.35" font-family="Arial" font-size="12.00">Frontend (Next.js)</text>
<text text-anchor="middle" x="218" y="-411.1" font-family="Arial" font-size="12.00">Port 3000</text>
</g>
<!-- user&#45;&gt;frontend -->
<g id="edge1" class="edge">
<title>user&#45;&gt;frontend</title>
<path fill="none" stroke="black" d="M313.64,-614.58C317.27,-584.87 320.8,-523.2 296,-480 288.44,-466.83 276.42,-455.89 264.06,-447.26"/>
<polygon fill="black" stroke="black" points="266.17,-444.45 255.88,-441.93 262.35,-450.32 266.17,-444.45"/>
<text text-anchor="middle" x="343.53" y="-482.5" font-family="Arial" font-size="10.00">Upload PDF/Image</text>
</g>
<!-- frontend&#45;&gt;user -->
<g id="edge48" class="edge">
<title>frontend&#45;&gt;user</title>
<path fill="none" stroke="black" d="M212.44,-441C208.87,-455.78 206.51,-476.9 216.25,-492 226.76,-508.3 242.3,-496.28 256,-510 282.01,-536.04 296.9,-576.58 304.46,-603.67"/>
<polygon fill="black" stroke="black" points="301.06,-604.47 306.97,-613.25 307.83,-602.69 301.06,-604.47"/>
<text text-anchor="middle" x="254.12" y="-482.5" font-family="Arial" font-size="10.00">Show biomarkers</text>
</g>
<!-- file_api -->
<g id="node3" class="node">
<title>file_api</title>
<polygon fill="green" stroke="black" points="154.88,-1306.53 39.12,-1306.53 39.12,-1270.03 154.88,-1270.03 154.88,-1306.53"/>
<text text-anchor="middle" x="97" y="-1291.13" font-family="Arial" font-size="12.00">POST /files/upload</text>
<text text-anchor="middle" x="97" y="-1276.88" font-family="Arial" font-size="12.00">Router</text>
</g>
<!-- frontend&#45;&gt;file_api -->
<g id="edge2" class="edge">
<title>frontend&#45;&gt;file_api</title>
<path fill="none" stroke="black" d="M162.14,-440.88C126.02,-454.6 80.27,-477 50,-510 10.42,-553.15 0,-573.34 0,-631.89 0,-1109.53 0,-1109.53 0,-1109.53 0,-1169.62 43.24,-1228.71 71.98,-1261.35"/>
<polygon fill="black" stroke="black" points="69.34,-1263.64 78.64,-1268.71 74.53,-1258.94 69.34,-1263.64"/>
<text text-anchor="middle" x="31.88" y="-967.78" font-family="Arial" font-size="10.00">POST with file</text>
</g>
<!-- docproc_api -->
<g id="node9" class="node">
<title>docproc_api</title>
<polygon fill="yellow" stroke="black" points="283.75,-299.5 128.25,-299.5 128.25,-263 283.75,-263 283.75,-299.5"/>
<text text-anchor="middle" x="206" y="-284.1" font-family="Arial" font-size="12.00">POST /process_document</text>
<text text-anchor="middle" x="206" y="-269.85" font-family="Arial" font-size="12.00">Router</text>
</g>
<!-- frontend&#45;&gt;docproc_api -->
<g id="edge10" class="edge">
<title>frontend&#45;&gt;docproc_api</title>
<path fill="none" stroke="black" d="M176.31,-403.92C160.21,-394.83 143.53,-382.01 134.5,-365 122.74,-342.84 142.16,-321.51 163.72,-306.06"/>
<polygon fill="black" stroke="black" points="165.4,-309.15 171.74,-300.66 161.49,-303.34 165.4,-309.15"/>
<text text-anchor="middle" x="165.25" y="-355.5" font-family="Arial" font-size="10.00">POST {file_id}</text>
</g>
<!-- sse_stream -->
<g id="node12" class="node">
<title>sse_stream</title>
<polygon fill="wheat" stroke="black" points="414.38,-299.5 301.62,-299.5 301.62,-263 414.38,-263 414.38,-299.5"/>
<text text-anchor="middle" x="358" y="-284.1" font-family="Arial" font-size="12.00">SSE Stream</text>
<text text-anchor="middle" x="358" y="-269.85" font-family="Arial" font-size="12.00">GET /tasks/stream</text>
</g>
<!-- frontend&#45;&gt;sse_stream -->
<g id="edge13" class="edge">
<title>frontend&#45;&gt;sse_stream</title>
<path fill="none" stroke="black" d="M212.7,-403.77C209.34,-388.64 207.5,-367.15 218.75,-353 239.89,-326.43 262.57,-350.07 293,-335 307.18,-327.98 321.06,-317.39 332.33,-307.53"/>
<polygon fill="black" stroke="black" points="334.59,-310.2 339.64,-300.89 329.88,-305.02 334.59,-310.2"/>
<text text-anchor="middle" x="264.88" y="-355.5" font-family="Arial" font-size="10.00">Subscribe to updates</text>
</g>
<!-- file_service -->
<g id="node4" class="node">
<title>file_service</title>
<polygon fill="lightgreen" stroke="black" points="146.38,-1126.53 69.62,-1126.53 69.62,-1090.53 146.38,-1090.53 146.38,-1126.53"/>
<text text-anchor="middle" x="108" y="-1104.26" font-family="Arial" font-size="12.00">FileService</text>
</g>
<!-- file_api&#45;&gt;file_service -->
<g id="edge3" class="edge">
<title>file_api&#45;&gt;file_service</title>
<path fill="none" stroke="black" d="M98.09,-1269.59C100,-1238.76 103.95,-1174.98 106.24,-1137.91"/>
<polygon fill="black" stroke="black" points="109.71,-1138.6 106.83,-1128.4 102.72,-1138.17 109.71,-1138.6"/>
</g>
<!-- storage_decision -->
<g id="node5" class="node">
<title>storage_decision</title>
<polygon fill="lightgreen" stroke="black" points="112,-1031.53 33.52,-1013.53 112,-995.53 190.48,-1013.53 112,-1031.53"/>
<text text-anchor="middle" x="112" y="-1009.26" font-family="Arial" font-size="12.00">Storage Type</text>
</g>
<!-- file_service&#45;&gt;storage_decision -->
<g id="edge4" class="edge">
<title>file_service&#45;&gt;storage_decision</title>
<path fill="none" stroke="black" d="M108.75,-1090.04C109.32,-1076.84 110.11,-1058.44 110.77,-1043.11"/>
<polygon fill="black" stroke="black" points="114.27,-1043.28 111.2,-1033.14 107.27,-1042.98 114.27,-1043.28"/>
</g>
<!-- gcs -->
<g id="node6" class="node">
<title>gcs</title>
<polygon fill="palegreen" stroke="black" points="293.62,-882.66 158.38,-882.66 158.38,-846.66 293.62,-846.66 293.62,-882.66"/>
<text text-anchor="middle" x="226" y="-860.38" font-family="Arial" font-size="12.00">Google Cloud Storage</text>
</g>
<!-- storage_decision&#45;&gt;gcs -->
<g id="edge5" class="edge">
<title>storage_decision&#45;&gt;gcs</title>
<path fill="none" stroke="black" d="M123.35,-997.91C142.54,-973.19 181.65,-922.79 205.67,-891.85"/>
<polygon fill="black" stroke="black" points="208.31,-894.16 211.67,-884.11 202.78,-889.87 208.31,-894.16"/>
<text text-anchor="middle" x="174.94" y="-967.78" font-family="Arial" font-size="10.00">GCS enabled</text>
</g>
<!-- local_fs -->
<g id="node7" class="node">
<title>local_fs</title>
<polygon fill="palegreen" stroke="black" points="140,-882.66 34,-882.66 34,-846.66 140,-846.66 140,-882.66"/>
<text text-anchor="middle" x="87" y="-860.38" font-family="Arial" font-size="12.00">Local Filesystem</text>
</g>
<!-- storage_decision&#45;&gt;local_fs -->
<g id="edge6" class="edge">
<title>storage_decision&#45;&gt;local_fs</title>
<path fill="none" stroke="black" d="M99.21,-998.14C94.68,-992.13 90.11,-984.79 87.75,-977.28 79.18,-950.01 80.23,-917.11 82.67,-894.12"/>
<polygon fill="black" stroke="black" points="86.13,-894.63 83.88,-884.28 79.19,-893.77 86.13,-894.63"/>
<text text-anchor="middle" x="112.88" y="-967.78" font-family="Arial" font-size="10.00">Local mode</text>
</g>
<!-- postgres_file -->
<g id="node8" class="node">
<title>postgres_file</title>
<path fill="lightblue" stroke="black" d="M207.38,-733.44C207.38,-745.77 174.04,-755.78 133,-755.78 91.96,-755.78 58.62,-745.77 58.62,-733.44 58.62,-733.44 58.62,-532.34 58.62,-532.34 58.62,-520.01 91.96,-510 133,-510 174.04,-510 207.38,-520.01 207.38,-532.34 207.38,-532.34 207.38,-733.44 207.38,-733.44"/>
<path fill="none" stroke="black" d="M207.38,-733.44C207.38,-721.11 174.04,-711.09 133,-711.09 91.96,-711.09 58.62,-721.11 58.62,-733.44"/>
<text text-anchor="middle" x="133" y="-706.87" font-family="Arial" font-size="12.00">PostgreSQL</text>
<text text-anchor="middle" x="133" y="-692.62" font-family="Arial" font-size="12.00">FileRecord Table</text>
<text text-anchor="middle" x="133" y="-664.37" font-family="Arial" font-size="12.00">Columns:</text>
<text text-anchor="middle" x="133" y="-650.12" font-family="Arial" font-size="12.00">&#45; file_id (UUID)</text>
<text text-anchor="middle" x="133" y="-635.87" font-family="Arial" font-size="12.00">&#45; filename</text>
<text text-anchor="middle" x="133" y="-621.62" font-family="Arial" font-size="12.00">&#45; mimetype</text>
<text text-anchor="middle" x="133" y="-607.37" font-family="Arial" font-size="12.00">&#45; size</text>
<text text-anchor="middle" x="133" y="-593.12" font-family="Arial" font-size="12.00">&#45; storage_path</text>
<text text-anchor="middle" x="133" y="-578.87" font-family="Arial" font-size="12.00">&#45; user_id</text>
<text text-anchor="middle" x="133" y="-564.62" font-family="Arial" font-size="12.00">&#45; created_at</text>
<text text-anchor="middle" x="133" y="-550.37" font-family="Arial" font-size="12.00">&#45; document_reference_id</text>
</g>
<!-- gcs&#45;&gt;postgres_file -->
<g id="edge7" class="edge">
<title>gcs&#45;&gt;postgres_file</title>
<path fill="none" stroke="black" d="M219.01,-846.39C211.58,-828.02 199.09,-797.18 185.91,-764.61"/>
<polygon fill="black" stroke="black" points="189.18,-763.35 182.18,-755.39 182.69,-765.98 189.18,-763.35"/>
<text text-anchor="middle" x="206.01" y="-776.28" font-family="Arial" font-size="10.00">file_id</text>
</g>
<!-- local_fs&#45;&gt;postgres_file -->
<g id="edge8" class="edge">
<title>local_fs&#45;&gt;postgres_file</title>
<path fill="none" stroke="black" d="M90.46,-846.39C94.03,-828.56 99.95,-798.96 106.26,-767.44"/>
<polygon fill="black" stroke="black" points="109.68,-768.21 108.21,-757.71 102.82,-766.83 109.68,-768.21"/>
<text text-anchor="middle" x="117.28" y="-776.28" font-family="Arial" font-size="10.00">file_id</text>
</g>
<!-- postgres_file&#45;&gt;frontend -->
<g id="edge9" class="edge">
<title>postgres_file&#45;&gt;frontend</title>
<path fill="none" stroke="black" d="M123.28,-509.82C125.56,-499.39 129.01,-489.29 134,-480 141.36,-466.29 153.67,-455.31 166.63,-446.81"/>
<polygon fill="black" stroke="black" points="168.09,-450.01 174.83,-441.83 164.46,-444.03 168.09,-450.01"/>
<text text-anchor="middle" x="165.5" y="-482.5" font-family="Arial" font-size="10.00">FileRecordOut</text>
</g>
<!-- task_queue -->
<g id="node10" class="node">
<title>task_queue</title>
<polygon fill="wheat" stroke="black" points="272.25,-179.5 131.75,-179.5 131.75,-100.5 272.25,-100.5 272.25,-179.5"/>
<text text-anchor="middle" x="202" y="-164.1" font-family="Arial" font-size="12.00">Task Queue Manager</text>
<text text-anchor="middle" x="202" y="-135.85" font-family="Arial" font-size="12.00">Limits:</text>
<text text-anchor="middle" x="202" y="-121.6" font-family="Arial" font-size="12.00">&#45; Global: 10 concurrent</text>
<text text-anchor="middle" x="202" y="-107.35" font-family="Arial" font-size="12.00">&#45; Per&#45;user: 5 concurrent</text>
</g>
<!-- docproc_api&#45;&gt;task_queue -->
<g id="edge11" class="edge">
<title>docproc_api&#45;&gt;task_queue</title>
<path fill="none" stroke="black" d="M205.49,-262.61C204.98,-244.65 204.15,-215.97 203.44,-190.97"/>
<polygon fill="black" stroke="black" points="206.94,-191.2 203.16,-181.31 199.95,-191.4 206.94,-191.2"/>
<text text-anchor="middle" x="229.01" y="-200" font-family="Arial" font-size="10.00">Queue task</text>
</g>
<!-- background_worker -->
<g id="node11" class="node">
<title>background_worker</title>
<polygon fill="wheat" stroke="black" points="255.88,-52.5 134.12,-52.5 134.12,-16 255.88,-16 255.88,-52.5"/>
<text text-anchor="middle" x="195" y="-37.1" font-family="Arial" font-size="12.00">Background Worker</text>
<text text-anchor="middle" x="195" y="-22.85" font-family="Arial" font-size="12.00">(Thread Pool)</text>
</g>
<!-- task_queue&#45;&gt;background_worker -->
<g id="edge12" class="edge">
<title>task_queue&#45;&gt;background_worker</title>
<path fill="none" stroke="black" d="M199.37,-100.07C198.57,-88.16 197.7,-75.28 196.95,-64.17"/>
<polygon fill="black" stroke="black" points="200.46,-64.18 196.29,-54.43 193.48,-64.65 200.46,-64.18"/>
<text text-anchor="middle" x="234.83" y="-73" font-family="Arial" font-size="10.00">Assign to worker</text>
</g>
<!-- load_file -->
<g id="node13" class="node">
<title>load_file</title>
<polygon fill="cyan" stroke="black" points="597.5,-1031.78 482.5,-1031.78 482.5,-995.28 597.5,-995.28 597.5,-1031.78"/>
<text text-anchor="middle" x="540" y="-1016.38" font-family="Arial" font-size="12.00">1. Load File</text>
<text text-anchor="middle" x="540" y="-1002.13" font-family="Arial" font-size="12.00">Fetch from storage</text>
</g>
<!-- background_worker&#45;&gt;load_file -->
<g id="edge14" class="edge">
<title>background_worker&#45;&gt;load_file</title>
<path fill="none" stroke="black" d="M162.84,-52.93C135.28,-70.71 100,-100.9 100,-139 100,-423.5 100,-423.5 100,-423.5 100,-455.91 100.38,-470.92 125,-492 156.32,-518.81 186.27,-481.44 216,-510 297.02,-587.82 220.54,-657.53 275,-755.78 332.66,-859.81 446.07,-947.99 504.04,-988.59"/>
<polygon fill="black" stroke="black" points="501.73,-991.25 511.94,-994.07 505.71,-985.5 501.73,-991.25"/>
</g>
<!-- sse_stream&#45;&gt;frontend -->
<g id="edge47" class="edge">
<title>sse_stream&#45;&gt;frontend</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M351.18,-299.76C343.51,-317.76 329.65,-345.8 311,-365 298.26,-378.12 281.86,-389.4 266.39,-398.35"/>
<polygon fill="black" stroke="black" points="264.77,-395.24 257.72,-403.15 268.17,-401.36 264.77,-395.24"/>
<text text-anchor="middle" x="347.33" y="-355.5" font-family="Arial" font-size="10.00">SSE events</text>
</g>
<!-- load_file&#45;&gt;gcs -->
<g id="edge15" class="edge">
<title>load_file&#45;&gt;gcs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M470.66,-1007.9C412.32,-1002.94 334.25,-993.51 307.5,-977.28 270.37,-954.75 245,-908.28 233.33,-882.98"/>
<polygon fill="black" stroke="black" points="470.29,-1011.38 480.54,-1008.71 470.86,-1004.4 470.29,-1011.38"/>
<text text-anchor="middle" x="327.75" y="-967.78" font-family="Arial" font-size="10.00">Fetch file</text>
</g>
<!-- load_file&#45;&gt;local_fs -->
<g id="edge16" class="edge">
<title>load_file&#45;&gt;local_fs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M470.91,-1007.64C411.28,-1002.6 323.09,-993.19 247.5,-977.28 229.55,-973.5 225.93,-969.19 208,-965.28 182.15,-959.64 171.49,-971.23 149,-957.28 120.93,-939.86 102.59,-904.49 93.58,-883.15"/>
<polygon fill="black" stroke="black" points="470.31,-1011.1 480.56,-1008.43 470.88,-1004.12 470.31,-1011.1"/>
<text text-anchor="middle" x="267.75" y="-967.78" font-family="Arial" font-size="10.00">Fetch file</text>
</g>
<!-- convert_pdf -->
<g id="node14" class="node">
<title>convert_pdf</title>
<polygon fill="cyan" stroke="black" points="625.75,-882.91 482.25,-882.91 482.25,-846.41 625.75,-846.41 625.75,-882.91"/>
<text text-anchor="middle" x="554" y="-867.51" font-family="Arial" font-size="12.00">2. Convert PDF</text>
<text text-anchor="middle" x="554" y="-853.26" font-family="Arial" font-size="12.00">Max 3 concurrent pages</text>
</g>
<!-- load_file&#45;&gt;convert_pdf -->
<g id="edge17" class="edge">
<title>load_file&#45;&gt;convert_pdf</title>
<path fill="none" stroke="black" d="M541.69,-994.81C544.07,-969.87 548.43,-924.11 551.27,-894.3"/>
<polygon fill="black" stroke="black" points="554.74,-894.77 552.21,-884.49 547.77,-894.11 554.74,-894.77"/>
</g>
<!-- extract_metadata -->
<g id="node15" class="node">
<title>extract_metadata</title>
<polygon fill="cyan" stroke="black" points="600,-658.27 482,-658.27 482,-607.52 600,-607.52 600,-658.27"/>
<text text-anchor="middle" x="541" y="-642.87" font-family="Arial" font-size="12.00">3. Extract Metadata</text>
<text text-anchor="middle" x="541" y="-628.62" font-family="Arial" font-size="12.00">MetadataAgent</text>
<text text-anchor="middle" x="541" y="-614.37" font-family="Arial" font-size="12.00">(Gemini Vision)</text>
</g>
<!-- convert_pdf&#45;&gt;extract_metadata -->
<g id="edge18" class="edge">
<title>convert_pdf&#45;&gt;extract_metadata</title>
<path fill="none" stroke="black" d="M553,-846.01C550.88,-808.46 545.87,-719.99 543.04,-669.98"/>
<polygon fill="black" stroke="black" points="546.55,-670.03 542.49,-660.25 539.56,-670.43 546.55,-670.03"/>
</g>
<!-- extract_metadata&#45;&gt;sse_stream -->
<g id="edge21" class="edge">
<title>extract_metadata&#45;&gt;sse_stream</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M516.92,-607.23C487.6,-575.92 438.4,-519.06 409.5,-462 408.62,-460.27 380.35,-360.95 366.08,-310.71"/>
<polygon fill="black" stroke="black" points="369.53,-310.05 363.43,-301.38 362.8,-311.96 369.53,-310.05"/>
<text text-anchor="middle" x="452.25" y="-419" font-family="Arial" font-size="10.00">Emit: phase=detect</text>
</g>
<!-- extract_biomarkers -->
<g id="node16" class="node">
<title>extract_biomarkers</title>
<polygon fill="cyan" stroke="black" points="633.62,-447.88 504.38,-447.88 504.38,-397.12 633.62,-397.12 633.62,-447.88"/>
<text text-anchor="middle" x="569" y="-432.48" font-family="Arial" font-size="12.00">4. Extract Biomarkers</text>
<text text-anchor="middle" x="569" y="-418.23" font-family="Arial" font-size="12.00">GenericAgent</text>
<text text-anchor="middle" x="569" y="-403.98" font-family="Arial" font-size="12.00">(Gemini Vision)</text>
</g>
<!-- extract_metadata&#45;&gt;extract_biomarkers -->
<g id="edge22" class="edge">
<title>extract_metadata&#45;&gt;extract_biomarkers</title>
<path fill="none" stroke="black" d="M544.18,-607.15C548.07,-577.08 554.88,-524.8 561,-480 561.9,-473.42 562.88,-466.4 563.83,-459.64"/>
<polygon fill="black" stroke="black" points="567.29,-460.14 565.23,-449.74 560.36,-459.15 567.29,-460.14"/>
</g>
<!-- gemini -->
<g id="node20" class="node">
<title>gemini</title>
<polygon fill="plum" stroke="black" points="783.75,-651.14 658.25,-651.14 658.25,-614.64 783.75,-614.64 783.75,-651.14"/>
<text text-anchor="middle" x="721" y="-635.74" font-family="Arial" font-size="12.00">Google Gemini API</text>
<text text-anchor="middle" x="721" y="-621.49" font-family="Arial" font-size="12.00">Vision + Tool Calling</text>
</g>
<!-- extract_metadata&#45;&gt;gemini -->
<g id="edge19" class="edge">
<title>extract_metadata&#45;&gt;gemini</title>
<path fill="none" stroke="black" d="M600.44,-632.89C615.27,-632.89 631.36,-632.89 646.81,-632.89"/>
<polygon fill="black" stroke="black" points="646.4,-636.39 656.4,-632.89 646.4,-629.39 646.4,-636.39"/>
<text text-anchor="middle" x="629.12" y="-638.39" font-family="Arial" font-size="10.00">API call</text>
</g>
<!-- extract_biomarkers&#45;&gt;sse_stream -->
<g id="edge25" class="edge">
<title>extract_biomarkers&#45;&gt;sse_stream</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M529.4,-396.74C517.24,-389.45 503.71,-381.65 491,-375 481.48,-370.02 478.25,-370.46 469,-365 439.85,-347.78 409.17,-324.45 387.47,-306.95"/>
<polygon fill="black" stroke="black" points="389.88,-304.41 379.92,-300.8 385.46,-309.83 389.88,-304.41"/>
<text text-anchor="middle" x="515.5" y="-355.5" font-family="Arial" font-size="10.00">Emit: phase=process</text>
</g>
<!-- normalize -->
<g id="node17" class="node">
<title>normalize</title>
<polygon fill="cyan" stroke="black" points="625.38,-335 500.62,-335 500.62,-227.5 625.38,-227.5 625.38,-335"/>
<text text-anchor="middle" x="563" y="-319.6" font-family="Arial" font-size="12.00">5. Normalize Names</text>
<text text-anchor="middle" x="563" y="-305.35" font-family="Arial" font-size="12.00">NormalizerAgent</text>
<text text-anchor="middle" x="563" y="-277.1" font-family="Arial" font-size="12.00">Rules:</text>
<text text-anchor="middle" x="563" y="-262.85" font-family="Arial" font-size="12.00">&#45; Remove footnotes</text>
<text text-anchor="middle" x="563" y="-248.6" font-family="Arial" font-size="12.00">&#45; Clean subscripts</text>
<text text-anchor="middle" x="563" y="-234.35" font-family="Arial" font-size="12.00">&#45; Fix abbreviations</text>
</g>
<!-- extract_biomarkers&#45;&gt;normalize -->
<g id="edge26" class="edge">
<title>extract_biomarkers&#45;&gt;normalize</title>
<path fill="none" stroke="black" d="M567.94,-396.93C567.34,-382.9 566.55,-364.59 565.78,-346.74"/>
<polygon fill="black" stroke="black" points="569.28,-346.78 565.36,-336.94 562.29,-347.08 569.28,-346.78"/>
</g>
<!-- extract_biomarkers&#45;&gt;gemini -->
<g id="edge23" class="edge">
<title>extract_biomarkers&#45;&gt;gemini</title>
<path fill="none" stroke="black" d="M583.1,-448.12C591.84,-462.04 603.97,-479.16 617.5,-492 628.37,-502.31 635.47,-499.34 646,-510 673.63,-537.96 695.75,-577.91 708.62,-604.36"/>
<polygon fill="black" stroke="black" points="705.31,-605.55 712.76,-613.08 711.64,-602.55 705.31,-605.55"/>
<text text-anchor="middle" x="634.75" y="-482.5" font-family="Arial" font-size="10.00">API call</text>
</g>
<!-- deduplicate -->
<g id="node18" class="node">
<title>deduplicate</title>
<polygon fill="cyan" stroke="black" points="633.5,-158.25 482.5,-158.25 482.5,-121.75 633.5,-121.75 633.5,-158.25"/>
<text text-anchor="middle" x="558" y="-142.85" font-family="Arial" font-size="12.00">6. Deduplicate</text>
<text text-anchor="middle" x="558" y="-128.6" font-family="Arial" font-size="12.00">Remove duplicate values</text>
</g>
<!-- normalize&#45;&gt;deduplicate -->
<g id="edge27" class="edge">
<title>normalize&#45;&gt;deduplicate</title>
<path fill="none" stroke="black" d="M561.1,-227.21C560.39,-207.66 559.63,-186.27 559.03,-169.68"/>
<polygon fill="black" stroke="black" points="562.54,-169.93 558.68,-160.06 555.55,-170.18 562.54,-169.93"/>
</g>
<!-- pipeline_result -->
<g id="node19" class="node">
<title>pipeline_result</title>
<polygon fill="lightcyan" stroke="black" points="620.38,-52.25 525.62,-52.25 525.62,-16.25 620.38,-16.25 620.38,-52.25"/>
<text text-anchor="middle" x="573" y="-29.98" font-family="Arial" font-size="12.00">PipelineResult</text>
</g>
<!-- deduplicate&#45;&gt;pipeline_result -->
<g id="edge28" class="edge">
<title>deduplicate&#45;&gt;pipeline_result</title>
<path fill="none" stroke="black" d="M560.54,-121.4C562.82,-105.66 566.2,-82.29 568.86,-63.86"/>
<polygon fill="black" stroke="black" points="572.31,-64.49 570.28,-54.09 565.38,-63.48 572.31,-64.49"/>
</g>
<!-- engine_main -->
<g id="node21" class="node">
<title>engine_main</title>
<polygon fill="pink" stroke="black" points="1290.88,-1031.53 1079.12,-1031.53 1079.12,-995.53 1290.88,-995.53 1290.88,-1031.53"/>
<text text-anchor="middle" x="1185" y="-1009.26" font-family="Arial" font-size="12.00">Engine.process_raw_medical_data()</text>
</g>
<!-- pipeline_result&#45;&gt;engine_main -->
<g id="edge29" class="edge">
<title>pipeline_result&#45;&gt;engine_main</title>
<path fill="none" stroke="black" d="M620.79,-35.58C690.54,-38.87 812,-56.45 812,-139 812,-865.66 812,-865.66 812,-865.66 812,-906.85 796.89,-928.14 826,-957.28 859.32,-990.63 976.17,-1003.87 1067.62,-1009.12"/>
<polygon fill="black" stroke="black" points="1067.24,-1012.6 1077.41,-1009.65 1067.62,-1005.61 1067.24,-1012.6"/>
<text text-anchor="middle" x="868.25" y="-419" font-family="Arial" font-size="10.00">DocumentResourcesNew</text>
</g>
<!-- gemini&#45;&gt;extract_metadata -->
<g id="edge20" class="edge">
<title>gemini&#45;&gt;extract_metadata</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M646.81,-632.89C631.36,-632.89 615.27,-632.89 600.44,-632.89"/>
<polygon fill="black" stroke="black" points="646.4,-636.39 656.4,-632.89 646.4,-629.39 646.4,-636.39"/>
<text text-anchor="middle" x="629.12" y="-638.39" font-family="Arial" font-size="10.00">Metadata</text>
</g>
<!-- gemini&#45;&gt;extract_biomarkers -->
<g id="edge24" class="edge">
<title>gemini&#45;&gt;extract_biomarkers</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M713.15,-603.25C703.13,-570.64 683.23,-517.1 652,-480 641.67,-467.73 628.05,-456.98 614.83,-448.25"/>
<polygon fill="black" stroke="black" points="709.78,-604.2 715.98,-612.8 716.5,-602.22 709.78,-604.2"/>
<text text-anchor="middle" x="685.06" y="-482.5" font-family="Arial" font-size="10.00">Biomarkers</text>
</g>
<!-- biomarker_processor -->
<g id="node22" class="node">
<title>biomarker_processor</title>
<polygon fill="lightpink" stroke="black" points="1259.38,-882.66 1134.62,-882.66 1134.62,-846.66 1259.38,-846.66 1259.38,-882.66"/>
<text text-anchor="middle" x="1197" y="-860.38" font-family="Arial" font-size="12.00">BiomarkerProcessor</text>
</g>
<!-- engine_main&#45;&gt;biomarker_processor -->
<g id="edge32" class="edge">
<title>engine_main&#45;&gt;biomarker_processor</title>
<path fill="none" stroke="black" d="M1186.42,-995.11C1188.45,-970.26 1192.2,-924.36 1194.65,-894.43"/>
<polygon fill="black" stroke="black" points="1198.13,-894.82 1195.45,-884.57 1191.15,-894.25 1198.13,-894.82"/>
</g>
<!-- create_doc_ref -->
<g id="node28" class="node">
<title>create_doc_ref</title>
<polygon fill="gray" stroke="black" points="1709.25,-925.53 1514.75,-925.53 1514.75,-803.78 1709.25,-803.78 1709.25,-925.53"/>
<text text-anchor="middle" x="1612" y="-910.13" font-family="Arial" font-size="12.00">Create DocumentReferenceNode</text>
<text text-anchor="middle" x="1612" y="-881.88" font-family="Arial" font-size="12.00">Properties:</text>
<text text-anchor="middle" x="1612" y="-867.63" font-family="Arial" font-size="12.00">&#45; uuid, name, file_id</text>
<text text-anchor="middle" x="1612" y="-853.38" font-family="Arial" font-size="12.00">&#45; document_name</text>
<text text-anchor="middle" x="1612" y="-839.13" font-family="Arial" font-size="12.00">&#45; report_date</text>
<text text-anchor="middle" x="1612" y="-824.88" font-family="Arial" font-size="12.00">&#45; patient_id, user_id</text>
<text text-anchor="middle" x="1612" y="-810.63" font-family="Arial" font-size="12.00">&#45; source_type, content_type</text>
</g>
<!-- engine_main&#45;&gt;create_doc_ref -->
<g id="edge30" class="edge">
<title>engine_main&#45;&gt;create_doc_ref</title>
<path fill="none" stroke="black" d="M1291.22,-1008.59C1355.91,-1002.77 1438.77,-989.06 1506,-957.28 1519.54,-950.88 1532.69,-942.26 1544.87,-932.86"/>
<polygon fill="black" stroke="black" points="1546.76,-935.83 1552.37,-926.84 1542.38,-930.37 1546.76,-935.83"/>
</g>
<!-- catalog_search -->
<g id="node23" class="node">
<title>catalog_search</title>
<polygon fill="lightpink" stroke="black" points="1226.12,-651.14 1081.88,-651.14 1081.88,-614.64 1226.12,-614.64 1226.12,-651.14"/>
<text text-anchor="middle" x="1154" y="-635.74" font-family="Arial" font-size="12.00">Search Medical Catalog</text>
<text text-anchor="middle" x="1154" y="-621.49" font-family="Arial" font-size="12.00">Batch lookup</text>
</g>
<!-- biomarker_processor&#45;&gt;catalog_search -->
<g id="edge33" class="edge">
<title>biomarker_processor&#45;&gt;catalog_search</title>
<path fill="none" stroke="black" d="M1198.52,-846.31C1199.76,-828.13 1200.76,-798.78 1197,-773.78 1191.03,-734.03 1176.02,-689.99 1165.42,-662.14"/>
<polygon fill="black" stroke="black" points="1168.76,-661.06 1161.87,-653.01 1162.23,-663.6 1168.76,-661.06"/>
</g>
<!-- dedup_engine -->
<g id="node24" class="node">
<title>dedup_engine</title>
<polygon fill="lightpink" stroke="black" points="1263.12,-440.75 1106.88,-440.75 1106.88,-404.25 1263.12,-404.25 1263.12,-440.75"/>
<text text-anchor="middle" x="1185" y="-425.35" font-family="Arial" font-size="12.00">Deduplication</text>
<text text-anchor="middle" x="1185" y="-411.1" font-family="Arial" font-size="12.00">Group by (catalog_id, unit)</text>
</g>
<!-- catalog_search&#45;&gt;dedup_engine -->
<g id="edge38" class="edge">
<title>catalog_search&#45;&gt;dedup_engine</title>
<path fill="none" stroke="black" d="M1156.59,-614.48C1161.92,-578.63 1174.18,-496.23 1180.72,-452.3"/>
<polygon fill="black" stroke="black" points="1184.16,-452.91 1182.17,-442.5 1177.24,-451.88 1184.16,-452.91"/>
</g>
<!-- catalog_api -->
<g id="node26" class="node">
<title>catalog_api</title>
<polygon fill="plum" stroke="black" points="1052.25,-882.66 863.75,-882.66 863.75,-846.66 1052.25,-846.66 1052.25,-882.66"/>
<text text-anchor="middle" x="958" y="-860.38" font-family="Arial" font-size="12.00">POST /biomarkers/search_batch</text>
</g>
<!-- catalog_search&#45;&gt;catalog_api -->
<g id="edge34" class="edge">
<title>catalog_search&#45;&gt;catalog_api</title>
<path fill="none" stroke="black" d="M1154.92,-651.34C1155.58,-682.37 1152.42,-747.48 1118,-785.78 1101.93,-803.66 1088.94,-793.96 1067,-803.78 1042.89,-814.57 1016.93,-828.72 996.4,-840.56"/>
<polygon fill="black" stroke="black" points="994.68,-837.51 987.8,-845.57 998.2,-843.56 994.68,-837.51"/>
<text text-anchor="middle" x="1153.87" y="-776.28" font-family="Arial" font-size="10.00">HTTP POST</text>
</g>
<!-- converter -->
<g id="node25" class="node">
<title>converter</title>
<polygon fill="lightpink" stroke="black" points="1280.5,-299.25 1147.5,-299.25 1147.5,-263.25 1280.5,-263.25 1280.5,-299.25"/>
<text text-anchor="middle" x="1214" y="-276.98" font-family="Arial" font-size="12.00">ObservationConverter</text>
</g>
<!-- dedup_engine&#45;&gt;converter -->
<g id="edge39" class="edge">
<title>dedup_engine&#45;&gt;converter</title>
<path fill="none" stroke="black" d="M1188.67,-403.86C1193.55,-380.43 1202.24,-338.73 1208.06,-310.78"/>
<polygon fill="black" stroke="black" points="1211.44,-311.73 1210.05,-301.22 1204.58,-310.3 1211.44,-311.73"/>
</g>
<!-- create_obs_types -->
<g id="node29" class="node">
<title>create_obs_types</title>
<polygon fill="gray" stroke="black" points="1496.5,-918.41 1315.5,-918.41 1315.5,-810.91 1496.5,-810.91 1496.5,-918.41"/>
<text text-anchor="middle" x="1406" y="-903.01" font-family="Arial" font-size="12.00">Create ObservationTypeNodes</text>
<text text-anchor="middle" x="1406" y="-874.76" font-family="Arial" font-size="12.00">Properties:</text>
<text text-anchor="middle" x="1406" y="-860.51" font-family="Arial" font-size="12.00">&#45; catalog_id, unit</text>
<text text-anchor="middle" x="1406" y="-846.26" font-family="Arial" font-size="12.00">&#45; name, display_name</text>
<text text-anchor="middle" x="1406" y="-832.01" font-family="Arial" font-size="12.00">&#45; aliases, description</text>
<text text-anchor="middle" x="1406" y="-817.76" font-family="Arial" font-size="12.00">&#45; unit_properties</text>
</g>
<!-- converter&#45;&gt;create_obs_types -->
<g id="edge40" class="edge">
<title>converter&#45;&gt;create_obs_types</title>
<path fill="none" stroke="black" d="M1280.8,-283.49C1409.49,-287.48 1684.05,-304.27 1740,-375 1797.72,-447.97 1629.83,-688.1 1566,-755.78 1554.8,-767.66 1528.93,-786.13 1501.18,-804.46"/>
<polygon fill="black" stroke="black" points="1499.43,-801.42 1492.99,-809.83 1503.27,-807.27 1499.43,-801.42"/>
</g>
<!-- catalog_api&#45;&gt;catalog_search -->
<g id="edge37" class="edge">
<title>catalog_api&#45;&gt;catalog_search</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M968.71,-835.92C977.7,-816.04 992.36,-790 1012.75,-773.78 1032.63,-757.97 1046.56,-770.86 1067,-755.78 1105.08,-727.69 1132.99,-677.93 1145.94,-651.52"/>
<polygon fill="black" stroke="black" points="965.61,-834.27 964.89,-844.84 972.05,-837.02 965.61,-834.27"/>
<text text-anchor="middle" x="1063.38" y="-776.28" font-family="Arial" font-size="10.00">BiomarkerEntryResults</text>
</g>
<!-- qdrant -->
<g id="node27" class="node">
<title>qdrant</title>
<path fill="plum" stroke="black" d="M981.25,-693.36C981.25,-700.77 955.14,-706.8 923,-706.8 890.86,-706.8 864.75,-700.77 864.75,-693.36 864.75,-693.36 864.75,-572.42 864.75,-572.42 864.75,-565.01 890.86,-558.98 923,-558.98 955.14,-558.98 981.25,-565.01 981.25,-572.42 981.25,-572.42 981.25,-693.36 981.25,-693.36"/>
<path fill="none" stroke="black" d="M981.25,-693.36C981.25,-685.94 955.14,-679.92 923,-679.92 890.86,-679.92 864.75,-685.94 864.75,-693.36"/>
<text text-anchor="middle" x="923" y="-671.24" font-family="Arial" font-size="12.00">Qdrant</text>
<text text-anchor="middle" x="923" y="-656.99" font-family="Arial" font-size="12.00">Vector Search</text>
<text text-anchor="middle" x="923" y="-628.74" font-family="Arial" font-size="12.00">Embeddings for:</text>
<text text-anchor="middle" x="923" y="-614.49" font-family="Arial" font-size="12.00">&#45; Biomarker names</text>
<text text-anchor="middle" x="923" y="-600.24" font-family="Arial" font-size="12.00">&#45; Aliases</text>
<text text-anchor="middle" x="923" y="-585.99" font-family="Arial" font-size="12.00">&#45; Synonyms</text>
</g>
<!-- catalog_api&#45;&gt;qdrant -->
<g id="edge35" class="edge">
<title>catalog_api&#45;&gt;qdrant</title>
<path fill="none" stroke="black" d="M924.17,-846.21C902.36,-832.9 875.8,-812.35 863.25,-785.78 852.28,-762.57 856.56,-736.77 866.67,-713.11"/>
<polygon fill="black" stroke="black" points="869.8,-714.68 870.86,-704.14 863.46,-711.71 869.8,-714.68"/>
<text text-anchor="middle" x="898.12" y="-776.28" font-family="Arial" font-size="10.00">Vector similarity</text>
</g>
<!-- qdrant&#45;&gt;catalog_api -->
<g id="edge36" class="edge">
<title>qdrant&#45;&gt;catalog_api</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M935.87,-718.35C943,-765.21 951.25,-819.33 955.37,-846.39"/>
<polygon fill="black" stroke="black" points="939.37,-718.1 934.4,-708.74 932.45,-719.15 939.37,-718.1"/>
<text text-anchor="middle" x="964.43" y="-776.28" font-family="Arial" font-size="10.00">Matches</text>
</g>
<!-- neo4j_db -->
<g id="node32" class="node">
<title>neo4j_db</title>
<path fill="lightblue" stroke="black" d="M1807.5,-301.78C1807.5,-304.3 1784.42,-306.34 1756,-306.34 1727.58,-306.34 1704.5,-304.3 1704.5,-301.78 1704.5,-301.78 1704.5,-260.72 1704.5,-260.72 1704.5,-258.2 1727.58,-256.16 1756,-256.16 1784.42,-256.16 1807.5,-258.2 1807.5,-260.72 1807.5,-260.72 1807.5,-301.78 1807.5,-301.78"/>
<path fill="none" stroke="black" d="M1807.5,-301.78C1807.5,-299.26 1784.42,-297.22 1756,-297.22 1727.58,-297.22 1704.5,-299.26 1704.5,-301.78"/>
<text text-anchor="middle" x="1756" y="-284.1" font-family="Arial" font-size="12.00">Neo4j Database</text>
<text text-anchor="middle" x="1756" y="-269.85" font-family="Arial" font-size="12.00">Port 7474, 7687</text>
</g>
<!-- create_doc_ref&#45;&gt;neo4j_db -->
<g id="edge31" class="edge">
<title>create_doc_ref&#45;&gt;neo4j_db</title>
<path fill="none" stroke="black" d="M1709.54,-844.71C1744.63,-833.22 1781.55,-814.89 1806,-785.78 1895.18,-679.59 1899.22,-615.11 1868,-480 1853.38,-416.74 1811.28,-353.1 1783.07,-315.71"/>
<polygon fill="black" stroke="black" points="1786.01,-313.78 1777.14,-307.98 1780.45,-318.05 1786.01,-313.78"/>
<text text-anchor="middle" x="1907.6" y="-482.5" font-family="Arial" font-size="10.00">Cypher CREATE</text>
</g>
<!-- create_obs_values -->
<g id="node30" class="node">
<title>create_obs_values</title>
<polygon fill="gray" stroke="black" points="1557.38,-693.77 1372.62,-693.77 1372.62,-572.02 1557.38,-572.02 1557.38,-693.77"/>
<text text-anchor="middle" x="1465" y="-678.37" font-family="Arial" font-size="12.00">Create ObservationValueNodes</text>
<text text-anchor="middle" x="1465" y="-650.12" font-family="Arial" font-size="12.00">Properties:</text>
<text text-anchor="middle" x="1465" y="-635.87" font-family="Arial" font-size="12.00">&#45; value, unit</text>
<text text-anchor="middle" x="1465" y="-621.62" font-family="Arial" font-size="12.00">&#45; observation_date</text>
<text text-anchor="middle" x="1465" y="-607.37" font-family="Arial" font-size="12.00">&#45; value_epoch</text>
<text text-anchor="middle" x="1465" y="-593.12" font-family="Arial" font-size="12.00">&#45; patient_id, user_id</text>
<text text-anchor="middle" x="1465" y="-578.87" font-family="Arial" font-size="12.00">&#45; source_type, source_id</text>
</g>
<!-- create_obs_types&#45;&gt;create_obs_values -->
<g id="edge42" class="edge">
<title>create_obs_types&#45;&gt;create_obs_values</title>
<path fill="none" stroke="black" d="M1419.61,-810.65C1427.69,-779.2 1438.03,-738.93 1446.8,-704.77"/>
<polygon fill="black" stroke="black" points="1450.11,-705.94 1449.21,-695.38 1443.33,-704.2 1450.11,-705.94"/>
</g>
<!-- create_obs_types&#45;&gt;neo4j_db -->
<g id="edge41" class="edge">
<title>create_obs_types&#45;&gt;neo4j_db</title>
<path fill="none" stroke="black" d="M1492.05,-810.43C1496.71,-808.08 1501.38,-805.85 1506,-803.78 1571.44,-774.49 1608.63,-805.79 1660,-755.78 1782.67,-636.34 1770.75,-406.32 1760.88,-318"/>
<polygon fill="black" stroke="black" points="1764.38,-317.76 1759.73,-308.24 1757.43,-318.59 1764.38,-317.76"/>
<text text-anchor="middle" x="1802.09" y="-482.5" font-family="Arial" font-size="10.00">Cypher CREATE</text>
</g>
<!-- create_relationships -->
<g id="node31" class="node">
<title>create_relationships</title>
<polygon fill="gray" stroke="black" points="1614.75,-462 1315.25,-462 1315.25,-383 1614.75,-383 1614.75,-462"/>
<text text-anchor="middle" x="1465" y="-446.6" font-family="Arial" font-size="12.00">Create Relationships</text>
<text text-anchor="middle" x="1465" y="-418.35" font-family="Arial" font-size="12.00">DocumentReference&#45;[CONTAINS]&#45;&gt;ObservationType</text>
<text text-anchor="middle" x="1465" y="-404.1" font-family="Arial" font-size="12.00">ObservationType&#45;[HAS_VALUE]&#45;&gt;ObservationValue</text>
<text text-anchor="middle" x="1465" y="-389.85" font-family="Arial" font-size="12.00">Patient&#45;[HAS_OBSERVATION]&#45;&gt;ObservationValue</text>
</g>
<!-- create_obs_values&#45;&gt;create_relationships -->
<g id="edge44" class="edge">
<title>create_obs_values&#45;&gt;create_relationships</title>
<path fill="none" stroke="black" d="M1465,-571.62C1465,-540.52 1465,-503.04 1465,-473.56"/>
<polygon fill="black" stroke="black" points="1468.5,-473.8 1465,-463.8 1461.5,-473.8 1468.5,-473.8"/>
</g>
<!-- create_obs_values&#45;&gt;neo4j_db -->
<g id="edge43" class="edge">
<title>create_obs_values&#45;&gt;neo4j_db</title>
<path fill="none" stroke="black" d="M1524.59,-571.75C1555.24,-539.95 1592.65,-499.77 1624,-462 1664.64,-413.05 1707.49,-352.88 1732.97,-316.07"/>
<polygon fill="black" stroke="black" points="1735.72,-318.25 1738.51,-308.03 1729.96,-314.27 1735.72,-318.25"/>
<text text-anchor="middle" x="1727.74" y="-419" font-family="Arial" font-size="10.00">Cypher CREATE</text>
</g>
<!-- create_relationships&#45;&gt;sse_stream -->
<g id="edge46" class="edge">
<title>create_relationships&#45;&gt;sse_stream</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M1340.07,-382.54C1327.63,-379.6 1315.13,-377 1303,-375 1120.15,-344.79 649.83,-379.79 470,-335 444.66,-328.69 418.15,-316.49 397.29,-305.41"/>
<polygon fill="black" stroke="black" points="399.01,-302.37 388.56,-300.65 395.66,-308.51 399.01,-302.37"/>
<text text-anchor="middle" x="1244.65" y="-355.5" font-family="Arial" font-size="10.00">Emit: phase=complete</text>
</g>
<!-- create_relationships&#45;&gt;neo4j_db -->
<g id="edge45" class="edge">
<title>create_relationships&#45;&gt;neo4j_db</title>
<path fill="none" stroke="black" d="M1506.89,-382.84C1519.95,-372.15 1534.85,-361.24 1549.75,-353 1595.21,-327.86 1651.21,-309.34 1693.37,-297.57"/>
<polygon fill="black" stroke="black" points="1694.14,-300.99 1702.87,-294.98 1692.3,-294.24 1694.14,-300.99"/>
<text text-anchor="middle" x="1610.88" y="-355.5" font-family="Arial" font-size="10.00">Cypher MATCH + CREATE</text>
</g>
<!-- timing -->
<g id="node33" class="node">
<title>timing</title>
<polygon fill="white" stroke="black" points="867.5,-1413.03 704.5,-1413.03 704.5,-1163.53 873.5,-1163.53 873.5,-1407.03 867.5,-1413.03"/>
<polyline fill="none" stroke="black" points="867.5,-1413.03 867.5,-1407.03"/>
<polyline fill="none" stroke="black" points="873.5,-1407.03 867.5,-1407.03"/>
<text text-anchor="middle" x="789" y="-1398.58" font-family="Arial" font-size="11.00">Typical Processing Times:</text>
<text text-anchor="middle" x="789" y="-1372.08" font-family="Arial" font-size="11.00">File Upload: 0.5&#45;2s</text>
<text text-anchor="middle" x="789" y="-1358.58" font-family="Arial" font-size="11.00">Queue Wait: 0&#45;30s</text>
<text text-anchor="middle" x="789" y="-1345.08" font-family="Arial" font-size="11.00">PDF Conversion: 1&#45;3s per page</text>
<text text-anchor="middle" x="789" y="-1331.58" font-family="Arial" font-size="11.00">Metadata Extraction: 2&#45;4s</text>
<text text-anchor="middle" x="789" y="-1318.08" font-family="Arial" font-size="11.00">Biomarker Extraction: 5&#45;15s</text>
<text text-anchor="middle" x="789" y="-1304.58" font-family="Arial" font-size="11.00">Normalization: &lt;1s</text>
<text text-anchor="middle" x="789" y="-1291.08" font-family="Arial" font-size="11.00">Medical Catalog Search: 1&#45;3s</text>
<text text-anchor="middle" x="789" y="-1277.58" font-family="Arial" font-size="11.00">Deduplication: &lt;1s</text>
<text text-anchor="middle" x="789" y="-1264.08" font-family="Arial" font-size="11.00">Graph Storage: 2&#45;5s</text>
<text text-anchor="middle" x="789" y="-1237.58" font-family="Arial" font-size="11.00">Total: 15&#45;60s</text>
<text text-anchor="middle" x="789" y="-1211.08" font-family="Arial" font-size="11.00">Concurrency Limits:</text>
<text text-anchor="middle" x="789" y="-1197.58" font-family="Arial" font-size="11.00">&#45; Global: 10 documents</text>
<text text-anchor="middle" x="789" y="-1184.08" font-family="Arial" font-size="11.00">&#45; Per&#45;user: 5 documents</text>
<text text-anchor="middle" x="789" y="-1170.58" font-family="Arial" font-size="11.00">&#45; Page rendering: 3 concurrent</text>
</g>
<!-- biomarker_model -->
<g id="node34" class="node">
<title>biomarker_model</title>
<polygon fill="white" stroke="black" points="1278.5,-1386.53 1091.5,-1386.53 1091.5,-1190.03 1284.5,-1190.03 1284.5,-1380.53 1278.5,-1386.53"/>
<polyline fill="none" stroke="black" points="1278.5,-1386.53 1278.5,-1380.53"/>
<polyline fill="none" stroke="black" points="1284.5,-1380.53 1278.5,-1380.53"/>
<text text-anchor="middle" x="1188" y="-1372.08" font-family="Arial" font-size="11.00">Biomarker:</text>
<text text-anchor="middle" x="1188" y="-1358.58" font-family="Arial" font-size="11.00">&#45; long_name, short_name</text>
<text text-anchor="middle" x="1188" y="-1345.08" font-family="Arial" font-size="11.00">&#45; document_name</text>
<text text-anchor="middle" x="1188" y="-1331.58" font-family="Arial" font-size="11.00">&#45; aliases: list[str]</text>
<text text-anchor="middle" x="1188" y="-1318.08" font-family="Arial" font-size="11.00">&#45; values: list[BiomarkerValue]</text>
<text text-anchor="middle" x="1188" y="-1304.58" font-family="Arial" font-size="11.00">&#45; specimen_type</text>
<text text-anchor="middle" x="1188" y="-1291.08" font-family="Arial" font-size="11.00">&#45; panel_name</text>
<text text-anchor="middle" x="1188" y="-1264.58" font-family="Arial" font-size="11.00">BiomarkerValue:</text>
<text text-anchor="middle" x="1188" y="-1251.08" font-family="Arial" font-size="11.00">&#45; value, unit</text>
<text text-anchor="middle" x="1188" y="-1237.58" font-family="Arial" font-size="11.00">&#45; observation_date, observation_time</text>
<text text-anchor="middle" x="1188" y="-1224.08" font-family="Arial" font-size="11.00">&#45; name_location (page, x, y, w, h)</text>
<text text-anchor="middle" x="1188" y="-1210.58" font-family="Arial" font-size="11.00">&#45; value_location (page, x, y, w, h)</text>
<text text-anchor="middle" x="1188" y="-1197.08" font-family="Arial" font-size="11.00">&#45; unit_location (page, x, y, w, h)</text>
</g>
<!-- pattern -->
<g id="node35" class="node">
<title>pattern</title>
<polygon fill="white" stroke="black" points="1574.88,-1399.53 1405.12,-1399.53 1405.12,-1177.03 1580.88,-1177.03 1580.88,-1393.53 1574.88,-1399.53"/>
<polyline fill="none" stroke="black" points="1574.88,-1399.53 1574.88,-1393.53"/>
<polyline fill="none" stroke="black" points="1580.88,-1393.53 1574.88,-1393.53"/>
<text text-anchor="middle" x="1493" y="-1385.08" font-family="Arial" font-size="11.00">Multi&#45;Tenancy Pattern:</text>
<text text-anchor="middle" x="1493" y="-1358.58" font-family="Arial" font-size="11.00">Instance Layer (Patient&#45;Specific):</text>
<text text-anchor="middle" x="1493" y="-1345.08" font-family="Arial" font-size="11.00">&#45; DocumentReferenceNode</text>
<text text-anchor="middle" x="1493" y="-1331.58" font-family="Arial" font-size="11.00">&#45; ObservationValueNode</text>
<text text-anchor="middle" x="1493" y="-1318.08" font-family="Arial" font-size="11.00">Contains patient_id for scoping</text>
<text text-anchor="middle" x="1493" y="-1291.58" font-family="Arial" font-size="11.00">Type Layer (Shared):</text>
<text text-anchor="middle" x="1493" y="-1278.08" font-family="Arial" font-size="11.00">&#45; ObservationTypeNode</text>
<text text-anchor="middle" x="1493" y="-1264.58" font-family="Arial" font-size="11.00">Shared across all patients</text>
<text text-anchor="middle" x="1493" y="-1238.08" font-family="Arial" font-size="11.00">Benefits:</text>
<text text-anchor="middle" x="1493" y="-1224.58" font-family="Arial" font-size="11.00">&#45; No data duplication for types</text>
<text text-anchor="middle" x="1493" y="-1211.08" font-family="Arial" font-size="11.00">&#45; Consistent biomarker definitions</text>
<text text-anchor="middle" x="1493" y="-1197.58" font-family="Arial" font-size="11.00">&#45; Efficient catalog integration</text>
<text text-anchor="middle" x="1493" y="-1184.08" font-family="Arial" font-size="11.00">&#45; Patient data isolation</text>
</g>
</g>
</svg>
